<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to tern • tern</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to tern">
<meta property="og:description" content="tern">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125641273-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tern</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.7.6.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction.html">Introduction to tern</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/insightsengineering/tern" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to tern</h1>
            
            <h4 data-toc-skip class="date">2022-01-28</h4>
      
      <small class="dont-index">Source: <a href="https://github..com/insightsengineering/tern/blob/HEAD/vignettes/introduction.Rmd" class="external-link"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>tern</code> R package provides functions to create common analyses from clinical trials in <code>R</code>. The core functionality for tabulation is built on the more general purpose <code>rtables</code> package. New users should first begin by reading the “Introduction to rtables” vignette to become familiar with the <code>rtables</code> layout tabulation concepts.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span>topic <span class="op">=</span> <span class="st">"introduction"</span>, package <span class="op">=</span> <span class="st">"rtables"</span><span class="op">)</span></code></pre></div>
<p>In this vignette we are going to create:</p>
<ul>
<li>demographic table</li>
<li>adverse event table</li>
<li>response table</li>
</ul>
<p>using layout creating functions from <code>tern</code>.</p>
<p>The packages used in this vignette are:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/roche/rtables" class="external-link">rtables</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/insightsengineering/tern" class="external-link">tern</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></code></pre></div>
<p>The datasets used in this vignette are:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">adsl</span> <span class="op">&lt;-</span> <span class="va">ex_adsl</span>
<span class="va">adae</span> <span class="op">&lt;-</span> <span class="va">ex_adae</span>
<span class="va">adrs</span> <span class="op">&lt;-</span> <span class="va">ex_adrs</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="demographic-table">Demographic Table<a class="anchor" aria-label="anchor" href="#demographic-table"></a>
</h2>
<p>Demographic tables provide a summary of the characteristics of patients enrolled in a clinical trial. Typically the table columns represent treatment arms and variables summarized in the table are demographic properties such as age, sex, race, etc.</p>
<p>In the example below the only function from <code>tern</code> is <code><a href="../reference/summarize_variables.html">summarize_vars()</a></code> and the remaining layout functions are from <code>rtables</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Select variables to include in table.</span>
<span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AGE"</span>, <span class="st">"SEX"</span><span class="op">)</span>
<span class="va">var_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Age (yr)"</span>, <span class="st">"Sex"</span><span class="op">)</span>

<span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"ARM"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_overall_col.html" class="external-link">add_overall_col</a></span><span class="op">(</span><span class="st">"All Patients"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_colcounts.html" class="external-link">add_colcounts</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/summarize_variables.html">summarize_vars</a></span><span class="op">(</span>
    vars <span class="op">=</span> <span class="va">vars</span>,
    var_labels <span class="op">=</span> <span class="va">var_labels</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">adsl</span><span class="op">)</span>
<span class="co">#&gt;                      A: Drug X    B: Placebo   C: Combination   All Patients</span>
<span class="co">#&gt;                       (N=134)      (N=134)        (N=132)         (N=400)   </span>
<span class="co">#&gt; ————————————————————————————————————————————————————————————————————————————</span>
<span class="co">#&gt; Age (yr)                                                                    </span>
<span class="co">#&gt;   n                     134          134            132             400     </span>
<span class="co">#&gt;   Mean (SD)          33.8 (6.6)   35.4 (7.9)     35.4 (7.7)      34.9 (7.4) </span>
<span class="co">#&gt;   Median                 33           35             35              34     </span>
<span class="co">#&gt;   Min - Max           21 - 50      21 - 62        20 - 69         20 - 69   </span>
<span class="co">#&gt; Sex                                                                         </span>
<span class="co">#&gt;   n                     134          134            132             400     </span>
<span class="co">#&gt;   F                   79 (59%)    77 (57.5%)      66 (50%)      222 (55.5%) </span>
<span class="co">#&gt;   M                  51 (38.1%)    55 (41%)      60 (45.5%)     166 (41.5%) </span>
<span class="co">#&gt;   U                   3 (2.2%)     2 (1.5%)        4 (3%)         9 (2.2%)  </span>
<span class="co">#&gt;   UNDIFFERENTIATED    1 (0.7%)        0           2 (1.5%)        3 (0.8%)</span></code></pre></div>
<p>To change the display order of categorical variables in a table use factor variables and explicitly set the order of the levels. This is the case for the display order in columns and rows. Note that the <code>forcats</code> package has many useful functions to help with these types of data processing steps (not used below).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Reorder the levels in the ARM variable.</span>
<span class="va">adsl</span><span class="op">$</span><span class="va">ARM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">adsl</span><span class="op">$</span><span class="va">ARM</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B: Placebo"</span>, <span class="st">"A: Drug X"</span>, <span class="st">"C: Combination"</span><span class="op">)</span><span class="op">)</span> <span class="co"># nolint</span>

<span class="co"># Reorder the levels in the SEX variable.</span>
<span class="va">adsl</span><span class="op">$</span><span class="va">SEX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">adsl</span><span class="op">$</span><span class="va">SEX</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="st">"F"</span>, <span class="st">"U"</span>, <span class="st">"UNDIFFERENTIATED"</span><span class="op">)</span><span class="op">)</span> <span class="co"># nolint</span>

<span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"ARM"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_overall_col.html" class="external-link">add_overall_col</a></span><span class="op">(</span><span class="st">"All Patients"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_colcounts.html" class="external-link">add_colcounts</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/summarize_variables.html">summarize_vars</a></span><span class="op">(</span>
    vars <span class="op">=</span> <span class="va">vars</span>,
    var_labels <span class="op">=</span> <span class="va">var_labels</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">adsl</span><span class="op">)</span>
<span class="co">#&gt;                      B: Placebo   A: Drug X    C: Combination   All Patients</span>
<span class="co">#&gt;                       (N=134)      (N=134)        (N=132)         (N=400)   </span>
<span class="co">#&gt; ————————————————————————————————————————————————————————————————————————————</span>
<span class="co">#&gt; Age (yr)                                                                    </span>
<span class="co">#&gt;   n                     134          134            132             400     </span>
<span class="co">#&gt;   Mean (SD)          35.4 (7.9)   33.8 (6.6)     35.4 (7.7)      34.9 (7.4) </span>
<span class="co">#&gt;   Median                 35           33             35              34     </span>
<span class="co">#&gt;   Min - Max           21 - 62      21 - 50        20 - 69         20 - 69   </span>
<span class="co">#&gt; Sex                                                                         </span>
<span class="co">#&gt;   n                     134          134            132             400     </span>
<span class="co">#&gt;   M                   55 (41%)    51 (38.1%)     60 (45.5%)     166 (41.5%) </span>
<span class="co">#&gt;   F                  77 (57.5%)    79 (59%)       66 (50%)      222 (55.5%) </span>
<span class="co">#&gt;   U                   2 (1.5%)     3 (2.2%)        4 (3%)         9 (2.2%)  </span>
<span class="co">#&gt;   UNDIFFERENTIATED       0         1 (0.7%)       2 (1.5%)        3 (0.8%)</span></code></pre></div>
<p>The <code>tern</code> package includes many functions similar to <code><a href="../reference/summarize_variables.html">summarize_vars()</a></code>. These functions are called layout creating functions and are used in combination with other rtables layout functions just like in the examples above. Layout creating functions are wrapping calls to rtables <code><a href="https://roche.github.io/rtables/reference/analyze.html" class="external-link">analyze()</a></code>, <code><a href="https://roche.github.io/rtables/reference/analyze_colvars.html" class="external-link">analyze_colvars()</a></code> and <code><a href="https://roche.github.io/rtables/reference/summarize_row_groups.html" class="external-link">summarize_row_groups()</a></code> and provide options for easy formatting and analysis modifications.</p>
<p>To customize the display for the demographics table, we can do so via the arguments in <code><a href="../reference/summarize_variables.html">summarize_vars()</a></code>. Most layout creating functions in <code>tern</code> include the standard arguments <code>.stats</code>, <code>.formats</code>, <code>.labels</code> and <code>.indent_mods</code> which control which statistics are displayed and how the numbers are formatted. Refer to the package help with <code><a href="../reference/summarize_variables.html">help("summarize_vars")</a></code> or <code><a href="../reference/summarize_variables.html">?summarize_vars</a></code> to see the full set of options.</p>
<p>For this example we will change the default summary for numeric variables to include the number of records, and the mean and standard deviation (in a single statistic, i.e. within a single cell). For categorical variables we modify the summary to include the number of records and the counts of categories. We also modify the display format for the mean and standard deviation to print two decimal places instead of just one.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Select statistics and modify default formats.</span>
<span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"ARM"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_overall_col.html" class="external-link">add_overall_col</a></span><span class="op">(</span><span class="st">"All Patients"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_colcounts.html" class="external-link">add_colcounts</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/summarize_variables.html">summarize_vars</a></span><span class="op">(</span>
    vars <span class="op">=</span> <span class="va">vars</span>,
    var_labels <span class="op">=</span> <span class="va">var_labels</span>,
    .stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"mean_sd"</span>, <span class="st">"count"</span><span class="op">)</span>,
    .formats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mean_sd <span class="op">=</span> <span class="st">"xx.xx (xx.xx)"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">adsl</span><span class="op">)</span>
<span class="co">#&gt;                      B: Placebo     A: Drug X     C: Combination   All Patients</span>
<span class="co">#&gt;                        (N=134)       (N=134)         (N=132)         (N=400)   </span>
<span class="co">#&gt; ———————————————————————————————————————————————————————————————————————————————</span>
<span class="co">#&gt; Age (yr)                                                                       </span>
<span class="co">#&gt;   n                      134           134             132             400     </span>
<span class="co">#&gt;   Mean (SD)          35.43 (7.9)   33.77 (6.55)    35.43 (7.72)    34.88 (7.44)</span>
<span class="co">#&gt; Sex                                                                            </span>
<span class="co">#&gt;   n                      134           134             132             400     </span>
<span class="co">#&gt;   M                      55             51              60             166     </span>
<span class="co">#&gt;   F                      77             79              66             222     </span>
<span class="co">#&gt;   U                       2             3               4               9      </span>
<span class="co">#&gt;   UNDIFFERENTIATED        0             1               2               3</span></code></pre></div>
<p>One feature of a <code>layout</code> is that it can be used with different datasets to create different summaries. For example, here we can easily create the same summary of demographics for the Brazil and China subgroups, respectively:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">lyt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"ARM"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_overall_col.html" class="external-link">add_overall_col</a></span><span class="op">(</span><span class="st">"All Patients"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_colcounts.html" class="external-link">add_colcounts</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/summarize_variables.html">summarize_vars</a></span><span class="op">(</span>
    vars <span class="op">=</span> <span class="va">vars</span>,
    var_labels <span class="op">=</span> <span class="va">var_labels</span>
  <span class="op">)</span>

<span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">lyt</span>, df <span class="op">=</span> <span class="va">adsl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">COUNTRY</span> <span class="op">==</span> <span class="st">"BRA"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;                      B: Placebo   A: Drug X    C: Combination   All Patients</span>
<span class="co">#&gt;                        (N=7)        (N=13)         (N=10)          (N=30)   </span>
<span class="co">#&gt; ————————————————————————————————————————————————————————————————————————————</span>
<span class="co">#&gt; Age (yr)                                                                    </span>
<span class="co">#&gt;   n                      7            13             10              30     </span>
<span class="co">#&gt;   Mean (SD)           32 (6.1)    36.7 (6.4)    38.3 (10.6)      36.1 (8.1) </span>
<span class="co">#&gt;   Median                 32           37             35             35.5    </span>
<span class="co">#&gt;   Min - Max           25 - 42      24 - 47        25 - 64         24 - 64   </span>
<span class="co">#&gt; Sex                                                                         </span>
<span class="co">#&gt;   n                      7            13             10              30     </span>
<span class="co">#&gt;   M                  4 (57.1%)    8 (61.5%)       5 (50%)        17 (56.7%) </span>
<span class="co">#&gt;   F                  3 (42.9%)    5 (38.5%)       5 (50%)        13 (43.3%) </span>
<span class="co">#&gt;   U                      0            0              0               0      </span>
<span class="co">#&gt;   UNDIFFERENTIATED       0            0              0               0</span>

<span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">lyt</span>, df <span class="op">=</span> <span class="va">adsl</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">COUNTRY</span> <span class="op">==</span> <span class="st">"CHN"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;                      B: Placebo   A: Drug X    C: Combination   All Patients</span>
<span class="co">#&gt;                        (N=81)       (N=74)         (N=64)         (N=219)   </span>
<span class="co">#&gt; ————————————————————————————————————————————————————————————————————————————</span>
<span class="co">#&gt; Age (yr)                                                                    </span>
<span class="co">#&gt;   n                      81           74             64             219     </span>
<span class="co">#&gt;   Mean (SD)          35.7 (7.3)    33 (6.4)      35.2 (6.4)      34.6 (6.8) </span>
<span class="co">#&gt;   Median                 36           32             35              34     </span>
<span class="co">#&gt;   Min - Max           21 - 58      23 - 48        21 - 49         21 - 58   </span>
<span class="co">#&gt; Sex                                                                         </span>
<span class="co">#&gt;   n                      81           74             64             219     </span>
<span class="co">#&gt;   M                  35 (43.2%)   27 (36.5%)     30 (46.9%)       92 (42%)  </span>
<span class="co">#&gt;   F                  45 (55.6%)   44 (59.5%)     29 (45.3%)     118 (53.9%) </span>
<span class="co">#&gt;   U                   1 (1.2%)     2 (2.7%)       3 (4.7%)        6 (2.7%)  </span>
<span class="co">#&gt;   UNDIFFERENTIATED       0         1 (1.4%)       2 (3.1%)        3 (1.4%)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="adverse-event-table">Adverse Event Table<a class="anchor" aria-label="anchor" href="#adverse-event-table"></a>
</h2>
<p>The standard table of adverse events (AEs) is a summary by system organ class and preferred term. For frequency counts by preferred term, if there are multiple occurrences of the same AE in an individual we count them only once.</p>
<p>To create this table we will need to use a combination of several layout creating functions in a tabulation pipeline.</p>
<p>We start by creating the high-level summary. The layout creating function in <code>tern</code> that can do this is <code><a href="../reference/summarize_num_patients.html">summarize_num_patients()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"ACTARM"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_colcounts.html" class="external-link">add_colcounts</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_overall_col.html" class="external-link">add_overall_col</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"All Patients"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/summarize_num_patients.html">summarize_num_patients</a></span><span class="op">(</span>
    var <span class="op">=</span> <span class="st">"USUBJID"</span>,
    .stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"unique"</span>, <span class="st">"nonunique"</span><span class="op">)</span>,
    .labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
      unique <span class="op">=</span> <span class="st">"Total number of patients with at least one AE"</span>,
      nonunique <span class="op">=</span> <span class="st">"Overall total number of events"</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span>
    df <span class="op">=</span> <span class="va">adae</span>,
    alt_counts_df <span class="op">=</span> <span class="va">adsl</span>
  <span class="op">)</span>
<span class="co">#&gt;                                                 A: Drug X   B: Placebo    C: Combination   All Patients</span>
<span class="co">#&gt;                                                  (N=134)      (N=134)        (N=132)         (N=400)   </span>
<span class="co">#&gt; ———————————————————————————————————————————————————————————————————————————————————————————————————————</span>
<span class="co">#&gt; Total number of patients with at least one AE   122 (91%)   123 (91.8%)    120 (90.9%)     365 (91.2%) </span>
<span class="co">#&gt; Overall total number of events                     609          622            703             1934</span></code></pre></div>
<p>Note that for this table, the denominator used for percentages and shown in the header of the table <code>(N = xx)</code> is defined based on the subject-level dataset <code>adsl</code>. This is done by using the <code>alt_df_counts</code> argument in <code><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table()</a></code>, which provides an alternative data set for deriving the counts in the header. This is often required when we work with data sets that include multiple records per patient as <code>df</code>, such as <code>adae</code> here.</p>
<div class="section level3">
<h3 id="statistics-functions">Statistics Functions<a class="anchor" aria-label="anchor" href="#statistics-functions"></a>
</h3>
<p>Before building out the rest of the AE table it is helpful to introduce some more <code>tern</code> package design conventions. Each layout creating function in <code>tern</code> is a wrapper for a Statistics function. Statistics functions are the ones that do the actual computation of numbers in a table. These functions always return named lists whose elements are the statistics available to include in a layout via the <code>.stats</code> argument at the layout creating function level.</p>
<p>Statistics functions follow a naming convention to always begin with <code>s_*</code> and for ease of use are documented on the same page as their layout creating function counterpart. It is helpful to review a Statistic function to understand the logic used to calculate the numbers in a table and see what options may be available to modify the analysis.</p>
<p>For example, the Statistics function calculating the numbers in <code><a href="../reference/summarize_num_patients.html">summarize_num_patients()</a></code> is <code><a href="../reference/summarize_num_patients.html">s_num_patients()</a></code>. The results of this Statistics function is a list with the elements <code>unique</code>, <code>nonunique</code> and <code>unique_count</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/summarize_num_patients.html">s_num_patients</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">adae</span><span class="op">$</span><span class="va">USUBJID</span>, labelstr <span class="op">=</span> <span class="st">""</span>, .N_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">adae</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; $unique</span>
<span class="co">#&gt; [1] 365.000000   0.188728</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $nonunique</span>
<span class="co">#&gt; [1] 1934</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $unique_count</span>
<span class="co">#&gt; [1] 365</span>
<span class="co">#&gt; attr(,"label")</span>
<span class="co">#&gt; [1] " (n)"</span></code></pre></div>
<p>From these results you can see that the <code>unique</code> and <code>nonunique</code> statistics are those displayed in the “All Patients” column in the initial AE table output above. Also you can see that these are raw numbers and are not formatted in any way. All formatting functionality is handled at the layout creating function level with the <code>.formats</code> argument.</p>
<p>Now that we know what types of statistics can be derived by <code><a href="../reference/summarize_num_patients.html">s_num_patients()</a></code>, we can try modifying the default layout returned by <code><a href="../reference/summarize_num_patients.html">summarize_num_patients()</a></code>. Instead of reporting the <code>unique</code> and <code>nonqunie</code> statistics, we specify that the analysis should include only the <code>unique_count</code> statistic. The result will show only the counts of unique patients. Note we make this update in both the <code>.stats</code> and <code>.labels</code> argument of <code><a href="../reference/summarize_num_patients.html">summarize_num_patients()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"ACTARM"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_colcounts.html" class="external-link">add_colcounts</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_overall_col.html" class="external-link">add_overall_col</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"All Patients"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/summarize_num_patients.html">summarize_num_patients</a></span><span class="op">(</span>
    var <span class="op">=</span> <span class="st">"USUBJID"</span>,
    .stats <span class="op">=</span> <span class="st">"unique_count"</span>,
    .labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>unique_count <span class="op">=</span> <span class="st">"Total number of patients with at least one AE"</span><span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span>
    df <span class="op">=</span> <span class="va">adae</span>,
    alt_counts_df <span class="op">=</span> <span class="va">adsl</span>
  <span class="op">)</span>
<span class="co">#&gt;                                                 A: Drug X   B: Placebo   C: Combination   All Patients</span>
<span class="co">#&gt;                                                  (N=134)     (N=134)        (N=132)         (N=400)   </span>
<span class="co">#&gt; ——————————————————————————————————————————————————————————————————————————————————————————————————————</span>
<span class="co">#&gt; Total number of patients with at least one AE      122         123            120             365</span></code></pre></div>
<p>Let’s now continue building on the layout for the adverse event table.</p>
<p>After we have the top-level summary, we can repeat the same summary at each system organ class level. To do this we split the analysis data with <code><a href="https://roche.github.io/rtables/reference/split_rows_by.html" class="external-link">split_rows_by()</a></code> before calling again <code><a href="../reference/summarize_num_patients.html">summarize_num_patients()</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"ACTARM"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_colcounts.html" class="external-link">add_colcounts</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_overall_col.html" class="external-link">add_overall_col</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"All Patients"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/summarize_num_patients.html">summarize_num_patients</a></span><span class="op">(</span>
    var <span class="op">=</span> <span class="st">"USUBJID"</span>,
    .stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"unique"</span>, <span class="st">"nonunique"</span><span class="op">)</span>,
    .labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
      unique <span class="op">=</span> <span class="st">"Total number of patients with at least one AE"</span>,
      nonunique <span class="op">=</span> <span class="st">"Overall total number of events"</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_rows_by.html" class="external-link">split_rows_by</a></span><span class="op">(</span>
    <span class="st">"AEBODSYS"</span>,
    child_labels <span class="op">=</span> <span class="st">"visible"</span>,
    nested <span class="op">=</span> <span class="cn">FALSE</span>,
    indent_mod <span class="op">=</span> <span class="op">-</span><span class="fl">1L</span>,
    split_fun <span class="op">=</span> <span class="va">drop_split_levels</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/summarize_num_patients.html">summarize_num_patients</a></span><span class="op">(</span>
    var <span class="op">=</span> <span class="st">"USUBJID"</span>,
    .stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"unique"</span>, <span class="st">"nonunique"</span><span class="op">)</span>,
    .labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
      unique <span class="op">=</span> <span class="st">"Total number of patients with at least one AE"</span>,
      nonunique <span class="op">=</span> <span class="st">"Overall total number of events"</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span>
    df <span class="op">=</span> <span class="va">adae</span>,
    alt_counts_df <span class="op">=</span> <span class="va">adsl</span>
  <span class="op">)</span>
<span class="co">#&gt;                                                   A: Drug X    B: Placebo    C: Combination   All Patients</span>
<span class="co">#&gt;                                                    (N=134)       (N=134)        (N=132)         (N=400)   </span>
<span class="co">#&gt; ——————————————————————————————————————————————————————————————————————————————————————————————————————————</span>
<span class="co">#&gt; Total number of patients with at least one AE     122 (91%)    123 (91.8%)    120 (90.9%)     365 (91.2%) </span>
<span class="co">#&gt; Overall total number of events                       609           622            703             1934    </span>
<span class="co">#&gt; cl A.1                                                                                                    </span>
<span class="co">#&gt;   Total number of patients with at least one AE   78 (58.2%)    75 (56%)       89 (67.4%)     242 (60.5%) </span>
<span class="co">#&gt;   Overall total number of events                     132           130            160             422     </span>
<span class="co">#&gt; cl B.1                                                                                                    </span>
<span class="co">#&gt;   Total number of patients with at least one AE   47 (35.1%)   49 (36.6%)      43 (32.6%)     139 (34.8%) </span>
<span class="co">#&gt;   Overall total number of events                      56           60              62             178     </span>
<span class="co">#&gt; cl B.2                                                                                                    </span>
<span class="co">#&gt;   Total number of patients with at least one AE    79 (59%)    74 (55.2%)      85 (64.4%)     238 (59.5%) </span>
<span class="co">#&gt;   Overall total number of events                     129           138            143             410     </span>
<span class="co">#&gt; cl C.1                                                                                                    </span>
<span class="co">#&gt;   Total number of patients with at least one AE   43 (32.1%)   46 (34.3%)      43 (32.6%)      132 (33%)  </span>
<span class="co">#&gt;   Overall total number of events                      55           63              64             182     </span>
<span class="co">#&gt; cl C.2                                                                                                    </span>
<span class="co">#&gt;   Total number of patients with at least one AE   35 (26.1%)   48 (35.8%)      55 (41.7%)     138 (34.5%) </span>
<span class="co">#&gt;   Overall total number of events                      48           53              65             166     </span>
<span class="co">#&gt; cl D.1                                                                                                    </span>
<span class="co">#&gt;   Total number of patients with at least one AE    79 (59%)     67 (50%)       80 (60.6%)     226 (56.5%) </span>
<span class="co">#&gt;   Overall total number of events                     127           106            135             368     </span>
<span class="co">#&gt; cl D.2                                                                                                    </span>
<span class="co">#&gt;   Total number of patients with at least one AE   47 (35.1%)   58 (43.3%)      57 (43.2%)     162 (40.5%) </span>
<span class="co">#&gt;   Overall total number of events                      62           72              74             208</span></code></pre></div>
<p>The table looks almost ready. For the final step, we need a layout creating function that can produce a count table of event frequencies. The layout creating function for this is <code><a href="../reference/count_occurrences.html">count_occurrences()</a></code>. Let’s first try using this function in a simpler layout without row splits:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"ACTARM"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_colcounts.html" class="external-link">add_colcounts</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_overall_col.html" class="external-link">add_overall_col</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"All Patients"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/count_occurrences.html">count_occurrences</a></span><span class="op">(</span>vars <span class="op">=</span> <span class="st">"AEDECOD"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span>
    df <span class="op">=</span> <span class="va">adae</span>,
    alt_counts_df <span class="op">=</span> <span class="va">adsl</span>
  <span class="op">)</span>
<span class="co">#&gt;                 A: Drug X    B: Placebo   C: Combination   All Patients</span>
<span class="co">#&gt;                  (N=134)      (N=134)        (N=132)         (N=400)   </span>
<span class="co">#&gt; ———————————————————————————————————————————————————————————————————————</span>
<span class="co">#&gt; dcd A.1.1.1.1   50 (37.3%)   45 (33.6%)     63 (47.7%)     158 (39.5%) </span>
<span class="co">#&gt; dcd A.1.1.1.2   48 (35.8%)   48 (35.8%)     50 (37.9%)     146 (36.5%) </span>
<span class="co">#&gt; dcd B.1.1.1.1   47 (35.1%)   49 (36.6%)     43 (32.6%)     139 (34.8%) </span>
<span class="co">#&gt; dcd B.2.1.2.1   49 (36.6%)   44 (32.8%)     52 (39.4%)     145 (36.2%) </span>
<span class="co">#&gt; dcd B.2.2.3.1   48 (35.8%)   54 (40.3%)     51 (38.6%)     153 (38.2%) </span>
<span class="co">#&gt; dcd C.1.1.1.3   43 (32.1%)   46 (34.3%)     43 (32.6%)      132 (33%)  </span>
<span class="co">#&gt; dcd C.2.1.2.1   35 (26.1%)   48 (35.8%)     55 (41.7%)     138 (34.5%) </span>
<span class="co">#&gt; dcd D.1.1.1.1   50 (37.3%)   42 (31.3%)     51 (38.6%)     143 (35.8%) </span>
<span class="co">#&gt; dcd D.1.1.4.2   48 (35.8%)   42 (31.3%)     50 (37.9%)      140 (35%)  </span>
<span class="co">#&gt; dcd D.2.1.5.3   47 (35.1%)   58 (43.3%)     57 (43.2%)     162 (40.5%)</span></code></pre></div>
<p>Putting everything together, the final AE table looks like this:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"ACTARM"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_colcounts.html" class="external-link">add_colcounts</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_overall_col.html" class="external-link">add_overall_col</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"All Patients"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/summarize_num_patients.html">summarize_num_patients</a></span><span class="op">(</span>
    var <span class="op">=</span> <span class="st">"USUBJID"</span>,
    .stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"unique"</span>, <span class="st">"nonunique"</span><span class="op">)</span>,
    .labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
      unique <span class="op">=</span> <span class="st">"Total number of patients with at least one AE"</span>,
      nonunique <span class="op">=</span> <span class="st">"Overall total number of events"</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_rows_by.html" class="external-link">split_rows_by</a></span><span class="op">(</span>
    <span class="st">"AEBODSYS"</span>,
    child_labels <span class="op">=</span> <span class="st">"visible"</span>,
    nested <span class="op">=</span> <span class="cn">FALSE</span>,
    indent_mod <span class="op">=</span> <span class="op">-</span><span class="fl">1L</span>,
    split_fun <span class="op">=</span> <span class="va">drop_split_levels</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/summarize_num_patients.html">summarize_num_patients</a></span><span class="op">(</span>
    var <span class="op">=</span> <span class="st">"USUBJID"</span>,
    .stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"unique"</span>, <span class="st">"nonunique"</span><span class="op">)</span>,
    .labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
      unique <span class="op">=</span> <span class="st">"Total number of patients with at least one AE"</span>,
      nonunique <span class="op">=</span> <span class="st">"Overall total number of events"</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/count_occurrences.html">count_occurrences</a></span><span class="op">(</span>vars <span class="op">=</span> <span class="st">"AEDECOD"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span>
    df <span class="op">=</span> <span class="va">adae</span>,
    alt_counts_df <span class="op">=</span> <span class="va">adsl</span>
  <span class="op">)</span>
<span class="co">#&gt;                                                   A: Drug X    B: Placebo    C: Combination   All Patients</span>
<span class="co">#&gt;                                                    (N=134)       (N=134)        (N=132)         (N=400)   </span>
<span class="co">#&gt; ——————————————————————————————————————————————————————————————————————————————————————————————————————————</span>
<span class="co">#&gt; Total number of patients with at least one AE     122 (91%)    123 (91.8%)    120 (90.9%)     365 (91.2%) </span>
<span class="co">#&gt; Overall total number of events                       609           622            703             1934    </span>
<span class="co">#&gt; cl A.1                                                                                                    </span>
<span class="co">#&gt;   Total number of patients with at least one AE   78 (58.2%)    75 (56%)       89 (67.4%)     242 (60.5%) </span>
<span class="co">#&gt;   Overall total number of events                     132           130            160             422     </span>
<span class="co">#&gt;     dcd A.1.1.1.1                                 50 (37.3%)   45 (33.6%)      63 (47.7%)     158 (39.5%) </span>
<span class="co">#&gt;     dcd A.1.1.1.2                                 48 (35.8%)   48 (35.8%)      50 (37.9%)     146 (36.5%) </span>
<span class="co">#&gt; cl B.1                                                                                                    </span>
<span class="co">#&gt;   Total number of patients with at least one AE   47 (35.1%)   49 (36.6%)      43 (32.6%)     139 (34.8%) </span>
<span class="co">#&gt;   Overall total number of events                      56           60              62             178     </span>
<span class="co">#&gt;     dcd B.1.1.1.1                                 47 (35.1%)   49 (36.6%)      43 (32.6%)     139 (34.8%) </span>
<span class="co">#&gt; cl B.2                                                                                                    </span>
<span class="co">#&gt;   Total number of patients with at least one AE    79 (59%)    74 (55.2%)      85 (64.4%)     238 (59.5%) </span>
<span class="co">#&gt;   Overall total number of events                     129           138            143             410     </span>
<span class="co">#&gt;     dcd B.2.1.2.1                                 49 (36.6%)   44 (32.8%)      52 (39.4%)     145 (36.2%) </span>
<span class="co">#&gt;     dcd B.2.2.3.1                                 48 (35.8%)   54 (40.3%)      51 (38.6%)     153 (38.2%) </span>
<span class="co">#&gt; cl C.1                                                                                                    </span>
<span class="co">#&gt;   Total number of patients with at least one AE   43 (32.1%)   46 (34.3%)      43 (32.6%)      132 (33%)  </span>
<span class="co">#&gt;   Overall total number of events                      55           63              64             182     </span>
<span class="co">#&gt;     dcd C.1.1.1.3                                 43 (32.1%)   46 (34.3%)      43 (32.6%)      132 (33%)  </span>
<span class="co">#&gt; cl C.2                                                                                                    </span>
<span class="co">#&gt;   Total number of patients with at least one AE   35 (26.1%)   48 (35.8%)      55 (41.7%)     138 (34.5%) </span>
<span class="co">#&gt;   Overall total number of events                      48           53              65             166     </span>
<span class="co">#&gt;     dcd C.2.1.2.1                                 35 (26.1%)   48 (35.8%)      55 (41.7%)     138 (34.5%) </span>
<span class="co">#&gt; cl D.1                                                                                                    </span>
<span class="co">#&gt;   Total number of patients with at least one AE    79 (59%)     67 (50%)       80 (60.6%)     226 (56.5%) </span>
<span class="co">#&gt;   Overall total number of events                     127           106            135             368     </span>
<span class="co">#&gt;     dcd D.1.1.1.1                                 50 (37.3%)   42 (31.3%)      51 (38.6%)     143 (35.8%) </span>
<span class="co">#&gt;     dcd D.1.1.4.2                                 48 (35.8%)   42 (31.3%)      50 (37.9%)      140 (35%)  </span>
<span class="co">#&gt; cl D.2                                                                                                    </span>
<span class="co">#&gt;   Total number of patients with at least one AE   47 (35.1%)   58 (43.3%)      57 (43.2%)     162 (40.5%) </span>
<span class="co">#&gt;   Overall total number of events                      62           72              74             208     </span>
<span class="co">#&gt;     dcd D.2.1.5.3                                 47 (35.1%)   58 (43.3%)      57 (43.2%)     162 (40.5%)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="response-table">Response Table<a class="anchor" aria-label="anchor" href="#response-table"></a>
</h2>
<p>A typical response table for a binary clinical trial endpoint may be composed of several different analyses:</p>
<ul>
<li>Proportion of responders in each treatment group</li>
<li>Difference between proportion of responders in comparison groups vs. control group</li>
<li>Chi-Square test for difference in response rates between comparison groups vs. control group</li>
</ul>
<p>We can build a table layout like this by following the same approach we used for the AE table: each table section will be produced using a different layout creating function from <code>tern</code>.</p>
<p>First we start with some data preparation steps to set up the analysis dataset. We select the endpoint to analyze from <code>PARAMCD</code> and define the logical variable <code>is_rsp</code> which indicates whether a patient is classified as a responder or not.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Preprocessing to select an analysis endpoint.</span>
<span class="va">anl</span> <span class="op">&lt;-</span> <span class="va">adrs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">PARAMCD</span> <span class="op">==</span> <span class="st">"BESRSPI"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>is_rsp <span class="op">=</span> <span class="va">AVALC</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CR"</span>, <span class="st">"PR"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>To create a summary of the proportion of responders in each treatment group, use the <code><a href="../reference/estimate_proportions.html">estimate_proportion()</a></code> layout creating function:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"ARM"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_colcounts.html" class="external-link">add_colcounts</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/estimate_proportions.html">estimate_proportion</a></span><span class="op">(</span>
    vars <span class="op">=</span> <span class="st">"is_rsp"</span>,
    table_names <span class="op">=</span> <span class="st">"est_prop"</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">anl</span><span class="op">)</span>
<span class="co">#&gt;                                   A: Drug X      B: Placebo    C: Combination</span>
<span class="co">#&gt;                                    (N=134)        (N=134)         (N=132)    </span>
<span class="co">#&gt; —————————————————————————————————————————————————————————————————————————————</span>
<span class="co">#&gt; Responders                       114 (85.1%)     90 (67.2%)     120 (90.9%)  </span>
<span class="co">#&gt; 95% CI (Wald, with correction)   (78.7, 91.5)   (58.8, 75.5)    (85.6, 96.2)</span></code></pre></div>
<p>To specify which arm in the table should be used as the reference, use the argument <code>ref_group</code> from <code><a href="https://roche.github.io/rtables/reference/split_cols_by.html" class="external-link">split_cols_by()</a></code>. Below we change the reference arm to “B: Placebo” and so this arm is displayed as the first column:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"ARM"</span>, ref_group <span class="op">=</span> <span class="st">"B: Placebo"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_colcounts.html" class="external-link">add_colcounts</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/estimate_proportions.html">estimate_proportion</a></span><span class="op">(</span>
    vars <span class="op">=</span> <span class="st">"is_rsp"</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">anl</span><span class="op">)</span>
<span class="co">#&gt;                                   B: Placebo     A: Drug X     C: Combination</span>
<span class="co">#&gt;                                    (N=134)        (N=134)         (N=132)    </span>
<span class="co">#&gt; —————————————————————————————————————————————————————————————————————————————</span>
<span class="co">#&gt; Responders                        90 (67.2%)    114 (85.1%)     120 (90.9%)  </span>
<span class="co">#&gt; 95% CI (Wald, with correction)   (58.8, 75.5)   (78.7, 91.5)    (85.6, 96.2)</span></code></pre></div>
<p>To further customize the analysis, we can use the <code>method</code> and <code>conf_level</code> arguments to modify the type of confidence interval that is calculated:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"ARM"</span>, ref_group <span class="op">=</span> <span class="st">"B: Placebo"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_colcounts.html" class="external-link">add_colcounts</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/estimate_proportions.html">estimate_proportion</a></span><span class="op">(</span>
    vars <span class="op">=</span> <span class="st">"is_rsp"</span>,
    method <span class="op">=</span> <span class="st">"clopper-pearson"</span>,
    conf_level <span class="op">=</span> <span class="fl">0.9</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">anl</span><span class="op">)</span>
<span class="co">#&gt;                             B: Placebo     A: Drug X     C: Combination</span>
<span class="co">#&gt;                              (N=134)        (N=134)         (N=132)    </span>
<span class="co">#&gt; ———————————————————————————————————————————————————————————————————————</span>
<span class="co">#&gt; Responders                  90 (67.2%)    114 (85.1%)     120 (90.9%)  </span>
<span class="co">#&gt; 90% CI (Clopper-Pearson)   (59.9, 73.9)   (79.1, 89.9)    (85.7, 94.7)</span></code></pre></div>
<p>The next table section needed should summarize the difference in response rates between the reference arm each comparison arm. Use <code><a href="../reference/prop_difference.html">estimate_proportion_diff()</a></code> layout creating function for this:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"ARM"</span>, ref_group <span class="op">=</span> <span class="st">"B: Placebo"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_colcounts.html" class="external-link">add_colcounts</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/prop_difference.html">estimate_proportion_diff</a></span><span class="op">(</span>
    vars <span class="op">=</span> <span class="st">"is_rsp"</span>,
    show_labels <span class="op">=</span> <span class="st">"visible"</span>,
    var_labels <span class="op">=</span> <span class="st">"Unstratified Analysis"</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">anl</span><span class="op">)</span>
<span class="co">#&gt;                                      B: Placebo    A: Drug X    C: Combination</span>
<span class="co">#&gt;                                       (N=134)       (N=134)        (N=132)    </span>
<span class="co">#&gt; ——————————————————————————————————————————————————————————————————————————————</span>
<span class="co">#&gt; Unstratified Analysis                                                         </span>
<span class="co">#&gt;   Difference in Response rate (%)                    17.9            23.7     </span>
<span class="co">#&gt;     95% CI (Wald, with correction)                (7.2, 28.6)    (13.7, 33.8)</span></code></pre></div>
<p>The final section needed to complete the table includes a statistical test for the difference in response rates. Use the <code><a href="../reference/prop_diff_test.html">test_proportion_diff()</a></code> layout creating function for this:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"ARM"</span>, ref_group <span class="op">=</span> <span class="st">"B: Placebo"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_colcounts.html" class="external-link">add_colcounts</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/prop_diff_test.html">test_proportion_diff</a></span><span class="op">(</span>vars <span class="op">=</span> <span class="st">"is_rsp"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">anl</span><span class="op">)</span>
<span class="co">#&gt;                                B: Placebo   A: Drug X   C: Combination</span>
<span class="co">#&gt;                                 (N=134)      (N=134)       (N=132)    </span>
<span class="co">#&gt; ——————————————————————————————————————————————————————————————————————</span>
<span class="co">#&gt;   p-value (Chi-Squared Test)                 0.0006        &lt;0.0001</span></code></pre></div>
<p>To customize the output, we use the <code>method</code> argument to select a Chi-Squared test with Schouten correction.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"ARM"</span>, ref_group <span class="op">=</span> <span class="st">"B: Placebo"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_colcounts.html" class="external-link">add_colcounts</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/prop_diff_test.html">test_proportion_diff</a></span><span class="op">(</span>
    vars <span class="op">=</span> <span class="st">"is_rsp"</span>,
    method <span class="op">=</span> <span class="st">"schouten"</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">anl</span><span class="op">)</span>
<span class="co">#&gt;                                                         B: Placebo   A: Drug X   C: Combination</span>
<span class="co">#&gt;                                                          (N=134)      (N=134)       (N=132)    </span>
<span class="co">#&gt; ———————————————————————————————————————————————————————————————————————————————————————————————</span>
<span class="co">#&gt;   p-value (Chi-Squared Test with Schouten Correction)                 0.0008        &lt;0.0001</span></code></pre></div>
<p>Now we can put all the table sections together in one layout pipeline. Note there is one more small change needed. Since the primary analysis variable in all table sections is the same (<code>is_rsp</code>), we need to give each sub-table a unique name. This is done by adding the <code>table_names</code> argument and providing unique names through that:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_cols_by.html" class="external-link">split_cols_by</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"ARM"</span>, ref_group <span class="op">=</span> <span class="st">"B: Placebo"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/add_colcounts.html" class="external-link">add_colcounts</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/estimate_proportions.html">estimate_proportion</a></span><span class="op">(</span>
    vars <span class="op">=</span> <span class="st">"is_rsp"</span>,
    method <span class="op">=</span> <span class="st">"clopper-pearson"</span>,
    conf_level <span class="op">=</span> <span class="fl">0.9</span>,
    table_names <span class="op">=</span> <span class="st">"est_prop"</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/prop_difference.html">estimate_proportion_diff</a></span><span class="op">(</span>
    vars <span class="op">=</span> <span class="st">"is_rsp"</span>,
    show_labels <span class="op">=</span> <span class="st">"visible"</span>,
    var_labels <span class="op">=</span> <span class="st">"Unstratified Analysis"</span>,
    table_names <span class="op">=</span> <span class="st">"est_prop_diff"</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../reference/prop_diff_test.html">test_proportion_diff</a></span><span class="op">(</span>
    vars <span class="op">=</span> <span class="st">"is_rsp"</span>,
    method <span class="op">=</span> <span class="st">"schouten"</span>,
    table_names <span class="op">=</span> <span class="st">"test_prop_diff"</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">anl</span><span class="op">)</span>
<span class="co">#&gt;                                                          B: Placebo     A: Drug X     C: Combination</span>
<span class="co">#&gt;                                                           (N=134)        (N=134)         (N=132)    </span>
<span class="co">#&gt; ————————————————————————————————————————————————————————————————————————————————————————————————————</span>
<span class="co">#&gt; Responders                                               90 (67.2%)    114 (85.1%)     120 (90.9%)  </span>
<span class="co">#&gt; 90% CI (Clopper-Pearson)                                (59.9, 73.9)   (79.1, 89.9)    (85.7, 94.7) </span>
<span class="co">#&gt; Unstratified Analysis                                                                               </span>
<span class="co">#&gt;   Difference in Response rate (%)                                          17.9            23.7     </span>
<span class="co">#&gt;     95% CI (Wald, with correction)                                     (7.2, 28.6)     (13.7, 33.8) </span>
<span class="co">#&gt;   p-value (Chi-Squared Test with Schouten Correction)                     0.0008         &lt;0.0001</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>Tabulation with <code>tern</code> builds on top of the the layout tabulation framework from <code>rtables</code>. Complex tables are built step by step in a pipeline by combining layout creating functions that perform a specific type of analysis.</p>
<p>The <code>tern</code> layout functions introduced in this vignette are:</p>
<ul>
<li><code><a href="../reference/summarize_variables.html">summarize_vars()</a></code></li>
<li><code><a href="../reference/summarize_num_patients.html">summarize_num_patients()</a></code></li>
<li><code><a href="../reference/count_occurrences.html">count_occurrences()</a></code></li>
<li><code><a href="../reference/estimate_proportions.html">estimate_proportion()</a></code></li>
<li><code><a href="../reference/prop_difference.html">estimate_proportion_diff()</a></code></li>
<li><code><a href="../reference/prop_diff_test.html">test_proportion_diff()</a></code></li>
</ul>
<p>Layout creating functions build a formatted <code>layout</code> by controlling features such as labels, numerical display formats and indentation. These functions are wrappers for the Statistics functions which calculate the raw summaries of each analysis. You can easily spot Statistics functions in the documentation because they always begin with the prefix <code>s_</code>. It can be helpful to inspect and run Statistics functions to understand ways an analysis can be customized.</p>
<p>In summary, <code>tern</code> contains many additional functions for creating tables, listing and graphs used in clinical trials. The design of the package gives users a lot of flexibility to meet the analysis needs in a regulatory or exploratory reporting context.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by NEST, Roche, Saibah Chohan, Francois Collin, Nick Paszty, Ting Qi, Daniel Sabanes Bove, Jana Stoilova, Adrian Waddell, Heng Wang, Godwin Yung, Carreras Maximo, Zhao Rui, Wojciech Wojciak.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
