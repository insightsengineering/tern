<!DOCTYPE html>
<!-- Generated by pkgdown + https://github.com/insightsengineering/r-pkgdown-multiversion -->
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Formatting Functions • tern</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Formatting Functions">
<link rel="stylesheet" href="../consent.css">
<script src="../consent.js" type="text/javascript" charset="utf-8"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tern</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.7.9002</small>

    <div style="width: 140px; margin-left: 0.5rem;"> <small class="nav-text text-muted me-auto">part of</small> <img src="https://github.com/insightsengineering/hex-stickers/blob/main/PNG/nest.png?raw=true" alt="NEST" style="height: 30px;"><a href="https://pharmaverse.org/" class="external-link"><img src="https://github.com/insightsengineering/hex-stickers/blob/main/PNG/pharmaverse.png?raw=true" alt="pharmaverse" style="height: 28px;"></a> </div>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/tern.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/missing_values.html">Missing Values in Tern</a></li>
    <li><a class="dropdown-item" href="../articles/tables.html">Tabulation</a></li>
    <li><a class="dropdown-item" href="../articles/tern_formats.html">Formatting Functions</a></li>
    <li><a class="dropdown-item" href="../articles/tern_functions_guide.html">Understanding `tern` functions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-reports" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Reports</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-reports">
<li><a class="dropdown-item" href="../coverage-report/">Coverage report</a></li>
    <li><a class="dropdown-item" href="../unit-test-report/">Unit test report</a></li>
    <li><a class="dropdown-item" href="../unit-test-report-non-cran/">Non-CRAN unit test report</a></li>
  </ul>
</li>
      <div><li class="nav-item dropdown">
    <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-versions">Versions</a>
    <div class="dropdown-menu" aria-labelledby="dropdown-versions">
    <a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/release-candidate">release-candidate</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/latest-tag">latest-tag</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.9.7">v0.9.7</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.9.6">v0.9.6</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.9.5">v0.9.5</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.9.4">v0.9.4</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.9.3">v0.9.3</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.9.2">v0.9.2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.9.2-rc1">v0.9.2-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.9.1">v0.9.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.9.1-rc3">v0.9.1-rc3</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.9.0">v0.9.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.5">v0.8.5</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.5-rc2">v0.8.5-rc2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.5-rc1">v0.8.5-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.4">v0.8.4</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.4-rc1">v0.8.4-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.3-rc2">v0.8.3-rc2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.3-rc1">v0.8.3-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.2">v0.8.2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.2-rc2">v0.8.2-rc2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.2-rc1">v0.8.2-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.1">v0.8.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.0">v0.8.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.7.10">v0.7.10</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.7.9">v0.7.9</a>
</div>
</li></div>
</ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/insightsengineering/tern" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Formatting Functions</h1>
            
            <h4 data-toc-skip class="date">2023-01-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/insightsengineering/tern/blob/main/vignettes/tern_formats.Rmd" class="external-link"><code>vignettes/tern_formats.Rmd</code></a></small>
      <div class="d-none name"><code>tern_formats.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="tern-formatting-functions-overview">
<code>tern</code> Formatting Functions Overview<a class="anchor" aria-label="anchor" href="#tern-formatting-functions-overview"></a>
</h2>
<p>The <code>tern</code> R package provides functions to create common
analyses from clinical trials in <code>R</code> and these functions have
default formatting arguments for displaying the values in the output a
specific way.</p>
<p><code>tern</code> formatting differs compared to the formatting
available in the <code>formatters</code> package as <code>tern</code>
formats are capable of handling logical statements, allowing for more
fine-tuning of the output displayed. Depending on what type of value is
being displayed, and what that value is, the format of the output will
change. Whereas when using the <code>formatters</code> package, the
specified format is applied regardless of the value.</p>
<p>To see the available formatting functions available in
<code>tern</code> see <code><a href="../reference/formatting_functions.html">?formatting_functions</a></code>. To see the
available format strings available in <code>formatters</code> see
<code><a href="https://insightsengineering.github.io/formatters/latest-tag/reference/list_formats.html" class="external-link">formatters::list_valid_format_labels()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="comparing-tern-formatters-formats">Comparing <code>tern</code> &amp; <code>formatters</code>
Formats<a class="anchor" aria-label="anchor" href="#comparing-tern-formatters-formats"></a>
</h2>
<p>The packages used in this vignette are:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/insightsengineering/rtables" class="external-link">rtables</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://insightsengineering.github.io/formatters/" class="external-link">formatters</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://insightsengineering.github.io/tern/">tern</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<p>The example below demonstrates the use of <code>tern</code>
formatting in the <code><a href="../reference/abnormal.html">count_abnormal()</a></code> function. The example
“low” category has a non-zero numerator value so both a fraction and a
percentage value are displayed, while the “high” value has a numerator
value of zero and so the fraction value is displayed without also
displaying the redundant zero percentage value.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  RANGE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NORMAL"</span>, <span class="st">"LOW"</span>, <span class="st">"HIGH"</span>, <span class="st">"LOW"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  BL_RANGE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NORMAL"</span>, <span class="st">"NORMAL"</span>, <span class="st">"HIGH"</span>, <span class="st">"HIGH"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ONTRTFL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"Y"</span>, <span class="st">""</span>, <span class="st">"Y"</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="va">df2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ONTRTFL</span> <span class="op">==</span> <span class="st">"Y"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/abnormal.html">count_abnormal</a></span><span class="op">(</span></span>
<span>    var <span class="op">=</span> <span class="st">"RANGE"</span>,</span>
<span>    abnormal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"LOW"</span>, high <span class="op">=</span> <span class="st">"HIGH"</span><span class="op">)</span>,</span>
<span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"ID"</span>, baseline <span class="op">=</span> <span class="st">"BL_RANGE"</span><span class="op">)</span>,</span>
<span>    exclude_base_abn <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    .formats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fraction <span class="op">=</span> <span class="va">format_fraction</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span></span>
<span><span class="co">#&gt;         all obs  </span></span>
<span><span class="co">#&gt; —————————————————</span></span>
<span><span class="co">#&gt; low    2/2 (100%)</span></span>
<span><span class="co">#&gt; high      0/2</span></span></code></pre></div>
<p>In the following example the <code><a href="../reference/abnormal.html">count_abnormal()</a></code> function
is utilized again. This time both “low” values and “high” values have a
non-zero numerator and so both show a percentage.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  RANGE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NORMAL"</span>, <span class="st">"LOW"</span>, <span class="st">"HIGH"</span>, <span class="st">"HIGH"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  BL_RANGE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NORMAL"</span>, <span class="st">"NORMAL"</span>, <span class="st">"HIGH"</span>, <span class="st">"HIGH"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ONTRTFL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"Y"</span>, <span class="st">""</span>, <span class="st">"Y"</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="va">df2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ONTRTFL</span> <span class="op">==</span> <span class="st">"Y"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/abnormal.html">count_abnormal</a></span><span class="op">(</span></span>
<span>    var <span class="op">=</span> <span class="st">"RANGE"</span>,</span>
<span>    abnormal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"LOW"</span>, high <span class="op">=</span> <span class="st">"HIGH"</span><span class="op">)</span>,</span>
<span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"ID"</span>, baseline <span class="op">=</span> <span class="st">"BL_RANGE"</span><span class="op">)</span>,</span>
<span>    exclude_base_abn <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    .formats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fraction <span class="op">=</span> <span class="va">format_fraction</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span></span>
<span><span class="co">#&gt;         all obs </span></span>
<span><span class="co">#&gt; ————————————————</span></span>
<span><span class="co">#&gt; low    1/2 (50%)</span></span>
<span><span class="co">#&gt; high   1/2 (50%)</span></span></code></pre></div>
<p>The following example demonstrates the difference when
<code>formatters</code> is used instead to format the output. Here we
choose to use <code>"xx / xx"</code> as our value format. The “high”
value has a zero numerator value and the “low” value has a non-zero
numerator, yet both are displayed in the same format.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  RANGE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NORMAL"</span>, <span class="st">"LOW"</span>, <span class="st">"HIGH"</span>, <span class="st">"LOW"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  BL_RANGE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NORMAL"</span>, <span class="st">"NORMAL"</span>, <span class="st">"HIGH"</span>, <span class="st">"HIGH"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ONTRTFL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"Y"</span>, <span class="st">""</span>, <span class="st">"Y"</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="va">df2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ONTRTFL</span> <span class="op">==</span> <span class="st">"Y"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/abnormal.html">count_abnormal</a></span><span class="op">(</span></span>
<span>    var <span class="op">=</span> <span class="st">"RANGE"</span>,</span>
<span>    abnormal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"LOW"</span>, high <span class="op">=</span> <span class="st">"HIGH"</span><span class="op">)</span>,</span>
<span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"ID"</span>, baseline <span class="op">=</span> <span class="st">"BL_RANGE"</span><span class="op">)</span>,</span>
<span>    exclude_base_abn <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    .formats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fraction <span class="op">=</span> <span class="st">"xx / xx"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span></span>
<span><span class="co">#&gt;        all obs</span></span>
<span><span class="co">#&gt; ——————————————</span></span>
<span><span class="co">#&gt; low     2 / 2 </span></span>
<span><span class="co">#&gt; high    0 / 2</span></span></code></pre></div>
<p>The same concept occurs when using any of the available formats from
the <code>formatters</code> package. The following example displays the
same result using the <code>"xx.x / xx.x"</code> format instead. Use
<code><a href="https://insightsengineering.github.io/formatters/latest-tag/reference/list_formats.html" class="external-link">formatters::list_valid_format_labels()</a></code> to see the full list
of available formats in <code>formatters</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  RANGE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NORMAL"</span>, <span class="st">"LOW"</span>, <span class="st">"HIGH"</span>, <span class="st">"LOW"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  BL_RANGE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NORMAL"</span>, <span class="st">"NORMAL"</span>, <span class="st">"HIGH"</span>, <span class="st">"HIGH"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ONTRTFL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"Y"</span>, <span class="st">""</span>, <span class="st">"Y"</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="va">df2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ONTRTFL</span> <span class="op">==</span> <span class="st">"Y"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/abnormal.html">count_abnormal</a></span><span class="op">(</span></span>
<span>    var <span class="op">=</span> <span class="st">"RANGE"</span>,</span>
<span>    abnormal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"LOW"</span>, high <span class="op">=</span> <span class="st">"HIGH"</span><span class="op">)</span>,</span>
<span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"ID"</span>, baseline <span class="op">=</span> <span class="st">"BL_RANGE"</span><span class="op">)</span>,</span>
<span>    exclude_base_abn <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    .formats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fraction <span class="op">=</span> <span class="st">"xx.x / xx.x"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span></span>
<span><span class="co">#&gt;         all obs </span></span>
<span><span class="co">#&gt; ————————————————</span></span>
<span><span class="co">#&gt; low    2.0 / 2.0</span></span>
<span><span class="co">#&gt; high   0.0 / 2.0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="formatting-function-basics">Formatting Function Basics<a class="anchor" aria-label="anchor" href="#formatting-function-basics"></a>
</h2>
<p>Current <code>tern</code> formatting functions consider some of the
following aspects when setting custom behaviors:</p>
<ul>
<li>Missing values - a custom value or string can be set to display for
missing values instead of <code>NA</code>.</li>
<li>0’s - if a cell value is zero, <code>tern</code> fraction formatting
functions will exclude the accompanying percentage value.</li>
<li>Number of decimal places to display - the number of decimal places
can be fixed if needed.</li>
<li>Value thresholds - a different format or value can be displayed
depending on whether the value is within a certain threshold.</li>
</ul>
<div class="section level4">
<h4 id="number-of-decimal-places-to-display">Number of Decimal Places to Display<a class="anchor" aria-label="anchor" href="#number-of-decimal-places-to-display"></a>
</h4>
<p>Two functions that set a fixed number of decimal places (specifically
1) are <code><a href="../reference/format_fraction_fixed_dp.html">format_fraction_fixed_dp()</a></code> and
<code><a href="../reference/format_count_fraction_fixed_dp.html">format_count_fraction_fixed_dp()</a></code>. By default, formatting
functions will remove trailing zeros, but these two functions will
always have one decimal place in their percentage, even if the digit is
a zero. See the following example:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/format_fraction_fixed_dp.html">format_fraction_fixed_dp</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>num <span class="op">=</span> <span class="fl">1L</span>, denom <span class="op">=</span> <span class="fl">3L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "1/3 (33.3%)"</span></span>
<span><span class="fu"><a href="../reference/format_fraction_fixed_dp.html">format_fraction_fixed_dp</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>num <span class="op">=</span> <span class="fl">1L</span>, denom <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "1/2 (50.0%)"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/format_count_fraction_fixed_dp.html">format_count_fraction_fixed_dp</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0.6667</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "2 (66.7%)"</span></span>
<span><span class="fu"><a href="../reference/format_count_fraction_fixed_dp.html">format_count_fraction_fixed_dp</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "2 (25.0%)"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="value-thresholds">Value Thresholds<a class="anchor" aria-label="anchor" href="#value-thresholds"></a>
</h4>
<p>Functions that set custom values according to a certain threshold
include <code><a href="../reference/format_extreme_values.html">format_extreme_values()</a></code>,
<code><a href="../reference/format_extreme_values_ci.html">format_extreme_values_ci()</a></code>, and
<code><a href="../reference/format_fraction_threshold.html">format_fraction_threshold()</a></code>. The extreme value formats work
similarly to allow the user to specify the maximum number of digits to
include, and very large or very small values are given a special string
value. For example:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">extreme_format</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_extreme_values.html">format_extreme_values</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/extreme_format.html">extreme_format</a></span><span class="op">(</span><span class="fl">0.235</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "0.23"</span></span>
<span><span class="fu"><a href="../reference/extreme_format.html">extreme_format</a></span><span class="op">(</span><span class="fl">0.001</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "&lt;0.01"</span></span>
<span><span class="fu"><a href="../reference/extreme_format.html">extreme_format</a></span><span class="op">(</span><span class="cn">Inf</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "&gt;999.99"</span></span></code></pre></div>
<p>The <code><a href="../reference/format_fraction_threshold.html">format_fraction_threshold()</a></code> function allows the user
to specify a lower percentage threshold, below which values are instead
assigned a special string value. For example:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fraction_format</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_fraction_threshold.html">format_fraction_threshold</a></span><span class="op">(</span><span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu">fraction_format</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="fu">fraction_format</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "&lt;5"</span></span></code></pre></div>
<p>See the documentation on each function for specific details on their
behavior and how to customize them.</p>
</div>
</div>
<div class="section level2">
<h2 id="creating-custom-formatting-functions">Creating Custom Formatting Functions<a class="anchor" aria-label="anchor" href="#creating-custom-formatting-functions"></a>
</h2>
<p>If your table requires customized output that cannot be displayed
using one of the pre-existing <code>tern</code> formatting functions,
you may want to consider creating a new formatting function. When
creating your own formatting function it is important to consider the
aspects listed in the Formatting Function Customization section
above.</p>
<p>In this section we will create a custom formatting function derived
from the <code><a href="../reference/format_fraction_fixed_dp.html">format_fraction_fixed_dp()</a></code> function. First we will
take a look at this function in detail and then we will customize
it.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First we will see how the format_fraction_fixed_dp code works and displays the outputs</span></span>
<span><span class="va">format_fraction_fixed_dp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"label"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkVector.html" class="external-link">assert_vector</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkCount.html" class="external-link">assert_count</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"num"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkCount.html" class="external-link">assert_count</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"denom"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"num"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"num"</span><span class="op">]</span>, <span class="st">"/"</span>, <span class="va">x</span><span class="op">[</span><span class="st">"denom"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>      <span class="va">x</span><span class="op">[</span><span class="st">"num"</span><span class="op">]</span>, <span class="st">"/"</span>, <span class="va">x</span><span class="op">[</span><span class="st">"denom"</span><span class="op">]</span>,</span>
<span>      <span class="st">" ("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.1f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"num"</span><span class="op">]</span> <span class="op">/</span> <span class="va">x</span><span class="op">[</span><span class="st">"denom"</span><span class="op">]</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="st">"%)"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Here we see that if the numerator value is greater than 0, the
fraction and percentage is displayed. If the numerator is 0, only the
fraction is shown. Percent values always display 1 decimal place. Below
we will create a dummy dataset and then observe the output value
behavior when this formatting function is applied.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  RANGE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NORMAL"</span>, <span class="st">"LOW"</span>, <span class="st">"HIGH"</span>, <span class="st">"LOW"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  BL_RANGE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NORMAL"</span>, <span class="st">"NORMAL"</span>, <span class="st">"HIGH"</span>, <span class="st">"HIGH"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  ONTRTFL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"Y"</span>, <span class="st">""</span>, <span class="st">"Y"</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ONTRTFL</span> <span class="op">==</span> <span class="st">"Y"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/abnormal.html">count_abnormal</a></span><span class="op">(</span></span>
<span>    var <span class="op">=</span> <span class="st">"RANGE"</span>,</span>
<span>    abnormal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"LOW"</span>, high <span class="op">=</span> <span class="st">"HIGH"</span><span class="op">)</span>,</span>
<span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"ID"</span>, baseline <span class="op">=</span> <span class="st">"BL_RANGE"</span><span class="op">)</span>,</span>
<span>    exclude_base_abn <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    .formats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fraction <span class="op">=</span> <span class="va">format_fraction_fixed_dp</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span></span>
<span><span class="co">#&gt;          all obs   </span></span>
<span><span class="co">#&gt; ———————————————————</span></span>
<span><span class="co">#&gt; low    2/2 (100.0%)</span></span>
<span><span class="co">#&gt; high       0/2</span></span></code></pre></div>
<p>Now we will modify this function to make our custom formatting
function, <code>custom_format</code>. We want to display 3 decimal
places in the percent value, and if the numerator value is 0 we only
want to display a 0 value (without the denominator).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">custom_format</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"label"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkVector.html" class="external-link">assert_vector</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkCount.html" class="external-link">assert_count</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"num"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkCount.html" class="external-link">assert_count</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"denom"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"num"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"num"</span><span class="op">]</span><span class="op">)</span> <span class="co"># We remove the denominator on this line so that only a 0 is displayed</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>      <span class="va">x</span><span class="op">[</span><span class="st">"num"</span><span class="op">]</span>, <span class="st">"/"</span>, <span class="va">x</span><span class="op">[</span><span class="st">"denom"</span><span class="op">]</span>,</span>
<span>      <span class="st">" ("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%.3f"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"num"</span><span class="op">]</span> <span class="op">/</span> <span class="va">x</span><span class="op">[</span><span class="st">"denom"</span><span class="op">]</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="st">"%)"</span> <span class="co"># We include 3 decimal places with %.3f</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/abnormal.html">count_abnormal</a></span><span class="op">(</span></span>
<span>    var <span class="op">=</span> <span class="st">"RANGE"</span>,</span>
<span>    abnormal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"LOW"</span>, high <span class="op">=</span> <span class="st">"HIGH"</span><span class="op">)</span>,</span>
<span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"ID"</span>, baseline <span class="op">=</span> <span class="st">"BL_RANGE"</span><span class="op">)</span>,</span>
<span>    exclude_base_abn <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    .formats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fraction <span class="op">=</span> <span class="va">custom_format</span><span class="op">)</span> <span class="co"># Here we implement our new custom_format function</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://insightsengineering.github.io/rtables/latest-tag/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span></span>
<span><span class="co">#&gt;           all obs    </span></span>
<span><span class="co">#&gt; —————————————————————</span></span>
<span><span class="co">#&gt; low    2/2 (100.000%)</span></span>
<span><span class="co">#&gt; high         0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>Each <code>tern</code> analysis function has pre-specified default
format functions to implement when generating output, some of which are
taken from the <code>formatters</code> package and some of which are
custom formatting functions stored in <code>tern</code>. These
<code>tern</code> functions differ compared to those from
<code>formatters</code> in that logical statements can be used to set
value-dependent customized formats. If you would like to create your own
custom formatting function to use with <code>tern</code>, be sure to
carefully consider which rules you want to implement to handle different
input values.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="nest">
  <p>tern is a part of the <strong>NEST</strong> and <a href="https://pharmaverse.org/" class="external-link"><strong>pharmaverse</strong></a>.</p>
</div>
<script type="text/javascript" src="../analytics.js"></script></footer>
</div>





  </body>
</html>
