# s_count_occurrences functions as expected with valid input and default arguments

    Code
      res
    Output
      $count
      $count$MH1
      [1] 3
      
      $count$MH2
      [1] 1
      
      $count$MH3
      [1] 1
      
      
      $count_fraction
      $count_fraction$MH1
      [1] 3.00 0.75
      
      $count_fraction$MH2
      [1] 1.00 0.25
      
      $count_fraction$MH3
      [1] 1.00 0.25
      
      
      $fraction
      $fraction$MH1
        num denom 
          3     4 
      
      $fraction$MH2
        num denom 
          1     4 
      
      $fraction$MH3
        num denom 
          1     4 
      
      

# s_count_occurrences functions as expected when requesting different denominator

    Code
      res
    Output
      $count
      $count$MH1
      [1] 3
      
      $count$MH2
      [1] 1
      
      $count$MH3
      [1] 1
      
      
      $count_fraction
      $count_fraction$MH1
      [1] 3 1
      
      $count_fraction$MH2
      [1] 1.0000000 0.3333333
      
      $count_fraction$MH3
      [1] 1.0000000 0.3333333
      
      
      $fraction
      $fraction$MH1
        num denom 
          3     3 
      
      $fraction$MH2
        num denom 
          1     3 
      
      $fraction$MH3
        num denom 
          1     3 
      
      

# count_occurrences functions as expected with valid input and default arguments

    Code
      res
    Output
                A           B    
              (N=5)       (N=4)  
      ———————————————————————————
      MH1   3 (60.0%)   1 (25.0%)
      MH2   1 (20.0%)   2 (50.0%)
      MH3   1 (20.0%)   1 (25.0%)
      MH4       0       1 (25.0%)

# count_occurrences functions as expected with label row specified

    Code
      res
    Output
                 all obs 
      ———————————————————
      MH Term            
        MH1     4 (44.4%)
        MH2     3 (33.3%)

# count_occurrences works as expected with risk difference column

    Code
      res
    Output
                      A: Drug X    B: Placebo   C: Combination   Risk Difference (%) (95% CI)
                       (N=202)      (N=177)        (N=162)                 (N=379)           
      ———————————————————————————————————————————————————————————————————————————————————————
      dcd A.1.1.1.1   17 (8.4%)    17 (9.6%)      14 (8.6%)            0.0 (-5.7 - 5.7)      
      dcd A.1.1.1.2   17 (8.4%)    14 (7.9%)      17 (10.5%)           1.6 (-3.9 - 7.1)      
      dcd B.1.1.1.1   15 (7.4%)    19 (10.7%)     15 (9.3%)           -2.1 (-7.8 - 3.6)      
      dcd B.2.1.2.1   17 (8.4%)    16 (9.0%)      13 (8.0%)            0.5 (-5.1 - 6.2)      
      dcd B.2.2.3.1   17 (8.4%)    15 (8.5%)      16 (9.9%)            1.1 (-4.5 - 6.6)      
      dcd C.1.1.1.3   15 (7.4%)    13 (7.3%)      18 (11.1%)           1.1 (-4.2 - 6.3)      
      dcd C.2.1.2.1   20 (9.9%)    14 (7.9%)      10 (6.2%)            3.2 (-2.6 - 8.9)      
      dcd D.1.1.1.1   17 (8.4%)    18 (10.2%)      7 (4.3%)           -0.5 (-6.3 - 5.3)      
      dcd D.1.1.4.2   16 (7.9%)    13 (7.3%)      16 (9.9%)            1.6 (-3.8 - 6.9)      
      dcd D.2.1.5.3   21 (10.4%)   20 (11.3%)     12 (7.4%)            0.5 (-5.7 - 6.8)      

---

    Code
      res
    Output
                        A: Drug X      B: Placebo     C: Combination   Risk Difference (%) (95% CI)
                         (N=202)         (N=177)         (N=162)                 (N=379)           
      —————————————————————————————————————————————————————————————————————————————————————————————
      dcd A.1.1.1.1         8              11               11              -1.6 (-6.0 - 2.8)      
      dcd A.1.1.1.2        11              10               13               0.5 (-4.1 - 5.1)      
      dcd B.1.1.1.1        12              14               11              -1.1 (-6.1 - 4.0)      
      dcd B.2.1.2.1        11              12               9               -0.5 (-5.3 - 4.3)      
      dcd B.2.2.3.1         7               9               15              -1.1 (-5.1 - 3.0)      
      dcd C.1.1.1.3        10              10               16               0.0 (-4.5 - 4.5)      
      dcd C.2.1.2.1        13              12               7                0.5 (-4.5 - 5.5)      
      dcd D.1.1.1.1        12              13               6               -0.5 (-5.5 - 4.5)      
      dcd D.1.1.4.2        12               8               15               2.1 (-2.4 - 6.6)      
      dcd D.2.1.5.3        14              16               10              -1.1 (-6.5 - 4.4)      
      dcd A.1.1.1.1     8 (4.0%)        11 (6.2%)       11 (6.8%)           -1.6 (-6.0 - 2.8)      
      dcd A.1.1.1.2     11 (5.4%)       10 (5.6%)       13 (8.0%)            0.5 (-4.1 - 5.1)      
      dcd B.1.1.1.1     12 (5.9%)       14 (7.9%)       11 (6.8%)           -1.1 (-6.1 - 4.0)      
      dcd B.2.1.2.1     11 (5.4%)       12 (6.8%)        9 (5.6%)           -0.5 (-5.3 - 4.3)      
      dcd B.2.2.3.1     7 (3.5%)        9 (5.1%)        15 (9.3%)           -1.1 (-5.1 - 3.0)      
      dcd C.1.1.1.3     10 (5.0%)       10 (5.6%)       16 (9.9%)            0.0 (-4.5 - 4.5)      
      dcd C.2.1.2.1     13 (6.4%)       12 (6.8%)        7 (4.3%)            0.5 (-4.5 - 5.5)      
      dcd D.1.1.1.1     12 (5.9%)       13 (7.3%)        6 (3.7%)           -0.5 (-5.5 - 4.5)      
      dcd D.1.1.4.2     12 (5.9%)       8 (4.5%)        15 (9.3%)            2.1 (-2.4 - 6.6)      
      dcd D.2.1.5.3     14 (6.9%)       16 (9.0%)       10 (6.2%)           -1.1 (-6.5 - 4.4)      
      dcd A.1.1.1.1   8/202 (4.0%)    11/177 (6.2%)   11/162 (6.8%)         -1.6 (-6.0 - 2.8)      
      dcd A.1.1.1.2   11/202 (5.4%)   10/177 (5.6%)   13/162 (8.0%)          0.5 (-4.1 - 5.1)      
      dcd B.1.1.1.1   12/202 (5.9%)   14/177 (7.9%)   11/162 (6.8%)         -1.1 (-6.1 - 4.0)      
      dcd B.2.1.2.1   11/202 (5.4%)   12/177 (6.8%)    9/162 (5.6%)         -0.5 (-5.3 - 4.3)      
      dcd B.2.2.3.1   7/202 (3.5%)    9/177 (5.1%)    15/162 (9.3%)         -1.1 (-5.1 - 3.0)      
      dcd C.1.1.1.3   10/202 (5.0%)   10/177 (5.6%)   16/162 (9.9%)          0.0 (-4.5 - 4.5)      
      dcd C.2.1.2.1   13/202 (6.4%)   12/177 (6.8%)    7/162 (4.3%)          0.5 (-4.5 - 5.5)      
      dcd D.1.1.1.1   12/202 (5.9%)   13/177 (7.3%)    6/162 (3.7%)         -0.5 (-5.5 - 4.5)      
      dcd D.1.1.4.2   12/202 (5.9%)   8/177 (4.5%)    15/162 (9.3%)          2.1 (-2.4 - 6.6)      
      dcd D.2.1.5.3   14/202 (6.9%)   16/177 (9.0%)   10/162 (6.2%)         -1.1 (-6.5 - 4.4)      

