<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
Fits a Cox regression model and estimate hazard ratio to describe the effect
size in a survival analysis."><title>Cox Proportional Hazards Regression — cox_regression • tern</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cox Proportional Hazards Regression — cox_regression"><meta property="og:description" content="
Fits a Cox regression model and estimate hazard ratio to describe the effect
size in a survival analysis."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><link rel="stylesheet" href="../consent.css"><script src="../consent.js" type="text/javascript" charset="utf-8"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tern</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.8.9004</small>

    <div style="width: 140px; margin-left: 0.5rem;"> <small class="nav-text text-muted me-auto">part of</small> <img src="https://github.com/insightsengineering/hex-stickers/blob/main/PNG/nest.png?raw=true" alt="NEST" style="height: 30px;"><a href="https://pharmaverse.org/" class="external-link"><img src="https://github.com/insightsengineering/hex-stickers/blob/main/PNG/pharmaverse.png?raw=true" alt="pharmaverse" style="height: 28px;"></a> </div>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/tern.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/tables.html">Tabulation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<!-- start dropdown for versions --> <li class="nav-item dropdown">
        <a href="#" class="nav-link dropdown-toggle"
          data-bs-toggle="dropdown" role="button"
          aria-expanded="false" aria-haspopup="true"
          id="dropdown-versions">Versions</a> <div class="dropdown-menu" aria-labelledby="dropdown-versions"> <a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/main">main</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/latest-tag">latest-tag</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/release-candidate">release-candidate</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.5-rc2">v0.8.5-rc2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.5-rc1">v0.8.5-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.4-rc1">v0.8.4-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.3-rc2">v0.8.3-rc2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.3-rc1">v0.8.3-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.2-rc2">v0.8.2-rc2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.2-rc1">v0.8.2-rc1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.7.10">v0.7.10</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.5">v0.8.5</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.4">v0.8.4</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.2">v0.8.2</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.1">v0.8.1</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.8.0">v0.8.0</a>
<a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/tern/v0.7.9">v0.7.9</a> </div></li>
<!-- end dropdown for versions -->
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/insightsengineering/tern">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Cox Proportional Hazards Regression</h1>
      <small class="dont-index">Source: <a href="https://github.com/insightsengineering/tern/blob/HEAD/R/cox_regression.R" class="external-link"><code>R/cox_regression.R</code></a></small>
      <div class="d-none name"><code>cox_regression.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="figures/lifecycle-stable.svg" alt="[Stable]"></a></p>
<p>Fits a Cox regression model and estimate hazard ratio to describe the effect
size in a survival analysis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">h_coxreg_univar_formulas</span><span class="op">(</span><span class="va">variables</span>, interaction <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu">h_coxreg_multivar_formula</span><span class="op">(</span><span class="va">variables</span><span class="op">)</span>

<span class="fu">fit_coxreg_univar</span><span class="op">(</span><span class="va">variables</span>, <span class="va">data</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, control <span class="op">=</span> <span class="fu"><a href="control_coxreg.html">control_coxreg</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="co"># S3 method for summary.coxph</span>
<span class="fu">tidy</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">h_coxreg_univar_extract</span><span class="op">(</span><span class="va">effect</span>, <span class="va">covar</span>, <span class="va">data</span>, <span class="va">mod</span>, control <span class="op">=</span> <span class="fu"><a href="control_coxreg.html">control_coxreg</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="co"># S3 method for coxreg.univar</span>
<span class="fu">tidy</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">fit_coxreg_multivar</span><span class="op">(</span><span class="va">variables</span>, <span class="va">data</span>, control <span class="op">=</span> <span class="fu"><a href="control_coxreg.html">control_coxreg</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="fu">h_coxreg_multivar_extract</span><span class="op">(</span><span class="va">var</span>, <span class="va">data</span>, <span class="va">mod</span>, control <span class="op">=</span> <span class="fu"><a href="control_coxreg.html">control_coxreg</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="co"># S3 method for coxreg.multivar</span>
<span class="fu">tidy</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">s_coxreg</span><span class="op">(</span><span class="va">df</span>, <span class="va">.var</span><span class="op">)</span>

<span class="fu">summarize_coxreg</span><span class="op">(</span>
  <span class="va">lyt</span>,
  <span class="va">conf_level</span>,
  multivar <span class="op">=</span> <span class="cn">FALSE</span>,
  vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"hr"</span>, <span class="st">"ci"</span>, <span class="st">"pval"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>variables</dt>
<dd><p>(<code>list</code>)<br> a named list corresponds to the names of variables found
in <code>data</code>, passed as a named list and corresponding to <code>time</code>, <code>event</code>, <code>arm</code>,
<code>strata</code>, and <code>covariates</code> terms. If <code>arm</code> is missing from <code>variables</code>, then
only Cox model(s) including the <code>covariates</code> will be fitted and the corresponding
effect estimates will be tabulated later.</p></dd>


<dt>interaction</dt>
<dd><p>(<code>flag</code>)<br> if <code>TRUE</code>, the model includes the
interaction between the studied treatment and candidate covariate. Note that
for univariate models without treatment arm, and multivariate models, no
interaction can be used so that this needs to be <code>FALSE</code>.</p></dd>


<dt>data</dt>
<dd><p>(<code>data frame</code>)<br> the dataset containing the variables to fit the
models.</p></dd>


<dt>at</dt>
<dd><p>(<code>list</code> of <code>numeric</code>)<br> when the candidate covariate is a
<code>numeric</code>, use <code>at</code> to specify the value of the covariate at which the
effect should be estimated.</p></dd>


<dt>control</dt>
<dd><p>(<code>list</code>)<br> a list of parameters as returned by the
helper function <code><a href="control_coxreg.html">control_coxreg()</a></code>.</p></dd>


<dt>x</dt>
<dd><p>(<code>list</code>)<br> Result of the Cox regression model fitted by <code>fit_coxreg_multivar()</code>.</p></dd>


<dt>...</dt>
<dd><p>additional arguments for the lower level functions.</p></dd>


<dt>effect</dt>
<dd><p>(<code>string</code>)<br> the treatment variable.</p></dd>


<dt>covar</dt>
<dd><p>(<code>string</code>)<br> the name of the covariate in the model.</p></dd>


<dt>mod</dt>
<dd><p>(<code>coxph</code>)<br> Cox regression model fitted by <code><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">survival::coxph()</a></code>.</p></dd>


<dt>df</dt>
<dd><p>(<code>data frame</code>)<br> data set containing all analysis variables.</p></dd>


<dt>.var, var</dt>
<dd><p>(<code>string</code>)<br> single variable name that is passed by <code>rtables</code> when requested
by a statistics function.</p></dd>


<dt>lyt</dt>
<dd><p>(<code>layout</code>)<br> input layout where analyses will be added to.</p></dd>


<dt>conf_level</dt>
<dd><p>(<code>proportion</code>)<br> confidence level of the interval.</p></dd>


<dt>multivar</dt>
<dd><p>(<code>flag</code>)<br> if <code>TRUE</code>, the multi-variable Cox regression will run
and no interaction will be considered between the studied treatment and c
candidate covariate. Default is <code>FALSE</code> for univariate Cox regression including
an arm variable. When no arm variable is included in the univariate Cox regression,
then also <code>TRUE</code> should be used to tabulate the covariate effect estimates instead
of the treatment arm effect estimate across models.</p></dd>


<dt>vars</dt>
<dd><p>(<code>character</code>)<br> the name of statistics to be reported among
<code>n</code> (number of observation),
<code>hr</code> (Hazard Ratio),
<code>ci</code> (confidence interval),
<code>pval</code> (p.value of the treatment effect) and
<code>pval_inter</code> (the p.value of the interaction effect between the treatment
and the covariate).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The function <code>h_coxreg_univar_formulas</code> returns a <code>character</code> vector coercible
into formulas (e.g <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">stats::as.formula()</a></code>).</p>


<p>The function <code>h_coxreg_univar_formulas</code> returns a <code>character</code> vector coercible
into formulas (e.g <code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">stats::as.formula()</a></code>).</p>


<p>The function <code>fit_coxreg_univar</code> returns a <code>coxreg.univar</code> class object which is a named list
with 5 elements:</p><ul><li><p><code>mod</code>: Cox regression models fitted by <code><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">survival::coxph()</a></code>.</p></li>
<li><p><code>data</code>: The original data frame input.</p></li>
<li><p><code>control</code>: The original control input.</p></li>
<li><p><code>vars</code>: The variables used in the model.</p></li>
<li><p><code>at</code>: Value of the covariate at which the effect should be estimated.</p></li>
</ul><p>The function <code>fit_coxreg_multivar</code> returns a <code>coxreg.multivar</code> class object which is a named list
with 4 elements:</p><ul><li><p><code>mod</code>: Cox regression model fitted by <code><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">survival::coxph()</a></code>.</p></li>
<li><p><code>data</code>: The original data frame input.</p></li>
<li><p><code>control</code>: The original control input.</p></li>
<li><p><code>vars</code>: The variables used in the model.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Cox models are the most commonly used methods to estimate the magnitude of
the effect in survival analysis. It assumes proportional hazards: the ratio
of the hazards between groups (e.g., two arms) is constant over time.
This ratio is referred to as the "hazard ratio" (HR) and is one of the
most commonly reported metrics to describe the effect size in survival
analysis (NEST Team, 2020).</p>
    </div>
    <div class="section level2">
    <h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a></h2>
    
<ul><li><p><code>h_coxreg_univar_formulas</code>: Helper for Cox Regression Formula</p>
<p>Creates a list of formulas. It is used internally by <code>fit_coxreg_univar()</code>
for the comparison of univariate Cox regression models.</p></li>
<li><p><code>h_coxreg_multivar_formula</code>: Helper for Multi-variable Cox Regression Formula</p>
<p>Creates a formulas string. It is used internally by <code>fit_coxreg_multivar()</code>
for the comparison of multi-variable Cox regression models. Interactions will not
be included in multi-variable Cox regression model.</p></li>
<li><p><code>fit_coxreg_univar</code>: Fit a series of univariate Cox regression models
given the inputs.</p></li>
<li><p><code>tidy.summary.coxph</code>: Custom tidy method for <code><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">survival::coxph()</a></code> summary results.</p>
<p>Tidy the <code><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">survival::coxph()</a></code> results into a <code>data.frame</code> to extract model results.</p></li>
<li><p><code>h_coxreg_univar_extract</code>: Utility function to help tabulate the result of
a univariate Cox regression model.</p></li>
<li><p><code>tidy.coxreg.univar</code>: Custom tidy method for a Univariate Cox Regression</p>
<p>Tidy up the result of a Cox regression model fitted by <code>fit_coxreg_univar()</code>.</p></li>
<li><p><code>fit_coxreg_multivar</code>: Fit a multi-variable Cox regression model.</p></li>
<li><p><code>h_coxreg_multivar_extract</code>: Tabulation of Multi-variable Cox Regressions</p>
<p>Utility function to help tabulate the result of a multi-variable Cox regression model
for a treatment/covariate variable.</p></li>
<li><p><code>tidy.coxreg.multivar</code>: Custom tidy method for a Multi-variable Cox Regression</p>
<p>Tidy up the result of a Cox regression model fitted by <code>fit_coxreg_multivar()</code>.</p></li>
<li><p><code>s_coxreg</code>: transforms the tabulated results from <code>fit_coxreg_univar()</code>
and <code>fit_coxreg_multivar()</code> into a list. Not much calculation is done here,
it rather prepares the data to be used by the layout creating function.</p></li>
<li><p><code>summarize_coxreg</code>: layout creating function.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The usual formatting arguments for the <em>layout creating</em> function
<code>summarize_coxreg</code> are not yet accepted (<code>.stats</code>, <code>.indent_mod</code>, <code>.formats</code>,
<code>.labels</code>).</p>
<p>When using <code>fit_coxreg_univar</code> there should be two study arms.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># Testing dataset [survival::bladder].</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/roche/rtables" class="external-link">rtables</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span>, kind <span class="op">=</span> <span class="st">"Mersenne-Twister"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dta_bladder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span></span>
<span class="r-in">  data <span class="op">=</span> <span class="va">bladder</span><span class="op">[</span><span class="va">bladder</span><span class="op">$</span><span class="va">enum</span> <span class="op">&lt;</span> <span class="fl">5</span>, <span class="op">]</span>,</span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span class="r-in">    time <span class="op">=</span> <span class="va">stop</span>,</span>
<span class="r-in">    status <span class="op">=</span> <span class="va">event</span>,</span>
<span class="r-in">    armcd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">rx</span><span class="op">)</span>,</span>
<span class="r-in">    covar1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">enum</span><span class="op">)</span>,</span>
<span class="r-in">    covar2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span>
<span class="r-in">      <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">enum</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">      levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"M"</span>, <span class="st">"M"</span><span class="op">)</span></span>
<span class="r-in">    <span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"armcd"</span> <span class="op">=</span> <span class="st">"ARM"</span>, <span class="st">"covar1"</span> <span class="op">=</span> <span class="st">"A Covariate Label"</span>, <span class="st">"covar2"</span> <span class="op">=</span> <span class="st">"Sex (F/M)"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">formatters</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/formatters/man/var_labels.html" class="external-link">var_labels</a></span><span class="op">(</span><span class="va">dta_bladder</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">labels</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">labels</span></span>
<span class="r-in"><span class="va">dta_bladder</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">20</span><span class="op">:</span><span class="fl">60</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dta_bladder</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">armcd</span> <span class="op">+</span> <span class="va">covar1</span>, data <span class="op">=</span> <span class="va">dta_bladder</span><span class="op">)</span>,</span>
<span class="r-in">  lty <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span>,</span>
<span class="r-in">  xlab <span class="op">=</span> <span class="st">"Months"</span>,</span>
<span class="r-in">  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue1"</span>, <span class="st">"blue2"</span>, <span class="st">"blue3"</span>, <span class="st">"blue4"</span>, <span class="st">"red1"</span>, <span class="st">"red2"</span>, <span class="st">"red3"</span>, <span class="st">"red4"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-plt img"><img src="cox_regression-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co"># `h_coxreg_univar_formulas`</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Simple formulas.</span></span>
<span class="r-in"><span class="fu">h_coxreg_univar_formulas</span><span class="op">(</span></span>
<span class="r-in">  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">    time <span class="op">=</span> <span class="st">"time"</span>, event <span class="op">=</span> <span class="st">"status"</span>, arm <span class="op">=</span> <span class="st">"armcd"</span>, covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"y"</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                        ref </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     "survival::Surv(time, status) ~ armcd" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                          X </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "survival::Surv(time, status) ~ armcd + X" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                          y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "survival::Surv(time, status) ~ armcd + y" </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Addition of an optional strata.</span></span>
<span class="r-in"><span class="fu">h_coxreg_univar_formulas</span><span class="op">(</span></span>
<span class="r-in">  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">    time <span class="op">=</span> <span class="st">"time"</span>, event <span class="op">=</span> <span class="st">"status"</span>, arm <span class="op">=</span> <span class="st">"armcd"</span>, covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"y"</span><span class="op">)</span>,</span>
<span class="r-in">    strata <span class="op">=</span> <span class="st">"SITE"</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                       ref </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     "survival::Surv(time, status) ~ armcd + strata(SITE)" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                         X </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "survival::Surv(time, status) ~ armcd + X + strata(SITE)" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                         y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "survival::Surv(time, status) ~ armcd + y + strata(SITE)" </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Inclusion of the interaction term.</span></span>
<span class="r-in"><span class="fu">h_coxreg_univar_formulas</span><span class="op">(</span></span>
<span class="r-in">  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">    time <span class="op">=</span> <span class="st">"time"</span>, event <span class="op">=</span> <span class="st">"status"</span>, arm <span class="op">=</span> <span class="st">"armcd"</span>, covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"y"</span><span class="op">)</span>,</span>
<span class="r-in">    strata <span class="op">=</span> <span class="st">"SITE"</span></span>
<span class="r-in">  <span class="op">)</span>,</span>
<span class="r-in">  interaction <span class="op">=</span> <span class="cn">TRUE</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                       ref </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     "survival::Surv(time, status) ~ armcd + strata(SITE)" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                         X </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "survival::Surv(time, status) ~ armcd * X + strata(SITE)" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                         y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "survival::Surv(time, status) ~ armcd * y + strata(SITE)" </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Only covariates fitted in separate models.</span></span>
<span class="r-in"><span class="fu">h_coxreg_univar_formulas</span><span class="op">(</span></span>
<span class="r-in">  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">    time <span class="op">=</span> <span class="st">"time"</span>, event <span class="op">=</span> <span class="st">"status"</span>, covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"y"</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                      X                                      y </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "survival::Surv(time, status) ~ 1 + X" "survival::Surv(time, status) ~ 1 + y" </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># `h_coxreg_multivar_formula`</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">h_coxreg_multivar_formula</span><span class="op">(</span></span>
<span class="r-in">  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">    time <span class="op">=</span> <span class="st">"AVAL"</span>, event <span class="op">=</span> <span class="st">"event"</span>, arm <span class="op">=</span> <span class="st">"ARMCD"</span>, covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RACE"</span>, <span class="st">"AGE"</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "survival::Surv(AVAL, event) ~ ARMCD + RACE + AGE"</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Addition of an optional strata.</span></span>
<span class="r-in"><span class="fu">h_coxreg_multivar_formula</span><span class="op">(</span></span>
<span class="r-in">  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">    time <span class="op">=</span> <span class="st">"AVAL"</span>, event <span class="op">=</span> <span class="st">"event"</span>, arm <span class="op">=</span> <span class="st">"ARMCD"</span>, covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RACE"</span>, <span class="st">"AGE"</span><span class="op">)</span>,</span>
<span class="r-in">    strata <span class="op">=</span> <span class="st">"SITE"</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "survival::Surv(AVAL, event) ~ ARMCD + RACE + AGE + strata(SITE)"</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Example without treatment arm.</span></span>
<span class="r-in"><span class="fu">h_coxreg_multivar_formula</span><span class="op">(</span></span>
<span class="r-in">  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">    time <span class="op">=</span> <span class="st">"AVAL"</span>, event <span class="op">=</span> <span class="st">"event"</span>, covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RACE"</span>, <span class="st">"AGE"</span><span class="op">)</span>,</span>
<span class="r-in">    strata <span class="op">=</span> <span class="st">"SITE"</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "survival::Surv(AVAL, event) ~ 1 + RACE + AGE + strata(SITE)"</span>
<span class="r-in"><span class="co"># fit_coxreg_univar</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Cox regression: arm + 1 covariate.</span></span>
<span class="r-in"><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">fit_coxreg_univar</span><span class="op">(</span></span>
<span class="r-in">  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">    time <span class="op">=</span> <span class="st">"time"</span>, event <span class="op">=</span> <span class="st">"status"</span>, arm <span class="op">=</span> <span class="st">"armcd"</span>,</span>
<span class="r-in">    covariates <span class="op">=</span> <span class="st">"covar1"</span></span>
<span class="r-in">  <span class="op">)</span>,</span>
<span class="r-in">  data <span class="op">=</span> <span class="va">dta_bladder</span>,</span>
<span class="r-in">  control <span class="op">=</span> <span class="fu"><a href="control_coxreg.html">control_coxreg</a></span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">0.91</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Cox regression: arm + 1 covariate + interaction, 2 candidate covariates.</span></span>
<span class="r-in"><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">fit_coxreg_univar</span><span class="op">(</span></span>
<span class="r-in">  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">    time <span class="op">=</span> <span class="st">"time"</span>, event <span class="op">=</span> <span class="st">"status"</span>, arm <span class="op">=</span> <span class="st">"armcd"</span>,</span>
<span class="r-in">    covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covar1"</span>, <span class="st">"covar2"</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span>,</span>
<span class="r-in">  data <span class="op">=</span> <span class="va">dta_bladder</span>,</span>
<span class="r-in">  control <span class="op">=</span> <span class="fu"><a href="control_coxreg.html">control_coxreg</a></span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">0.91</span>, interaction <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Cox regression: arm + 1 covariate, stratified analysis.</span></span>
<span class="r-in"><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">fit_coxreg_univar</span><span class="op">(</span></span>
<span class="r-in">  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">    time <span class="op">=</span> <span class="st">"time"</span>, event <span class="op">=</span> <span class="st">"status"</span>, arm <span class="op">=</span> <span class="st">"armcd"</span>, strata <span class="op">=</span> <span class="st">"covar2"</span>,</span>
<span class="r-in">    covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covar1"</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span>,</span>
<span class="r-in">  data <span class="op">=</span> <span class="va">dta_bladder</span>,</span>
<span class="r-in">  control <span class="op">=</span> <span class="fu"><a href="control_coxreg.html">control_coxreg</a></span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">0.91</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Cox regression: no arm, only covariates.</span></span>
<span class="r-in"><span class="va">mod4</span> <span class="op">&lt;-</span> <span class="fu">fit_coxreg_univar</span><span class="op">(</span></span>
<span class="r-in">  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">    time <span class="op">=</span> <span class="st">"time"</span>, event <span class="op">=</span> <span class="st">"status"</span>,</span>
<span class="r-in">    covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covar1"</span>, <span class="st">"covar2"</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span>,</span>
<span class="r-in">  data <span class="op">=</span> <span class="va">dta_bladder</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/roche/rtables" class="external-link">rtables</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span>, kind <span class="op">=</span> <span class="st">"Mersenne-Twister"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">dta_bladder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span></span>
<span class="r-in">  data <span class="op">=</span> <span class="va">bladder</span><span class="op">[</span><span class="va">bladder</span><span class="op">$</span><span class="va">enum</span> <span class="op">&lt;</span> <span class="fl">5</span>, <span class="op">]</span>,</span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span class="r-in">    time <span class="op">=</span> <span class="va">stop</span>,</span>
<span class="r-in">    status <span class="op">=</span> <span class="va">event</span>,</span>
<span class="r-in">    armcd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">rx</span><span class="op">)</span>,</span>
<span class="r-in">    covar1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">enum</span><span class="op">)</span>,</span>
<span class="r-in">    covar2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span>
<span class="r-in">      <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">enum</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">      levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F"</span>, <span class="st">"F"</span>, <span class="st">"M"</span>, <span class="st">"M"</span><span class="op">)</span></span>
<span class="r-in">    <span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"armcd"</span> <span class="op">=</span> <span class="st">"ARM"</span>, <span class="st">"covar1"</span> <span class="op">=</span> <span class="st">"A Covariate Label"</span>, <span class="st">"covar2"</span> <span class="op">=</span> <span class="st">"Sex (F/M)"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">formatters</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/formatters/man/var_labels.html" class="external-link">var_labels</a></span><span class="op">(</span><span class="va">dta_bladder</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">labels</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">labels</span></span>
<span class="r-in"><span class="va">dta_bladder</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">20</span><span class="op">:</span><span class="fl">60</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dta_bladder</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="st">"survival::Surv(time, status) ~ armcd + covar1"</span></span>
<span class="r-in"><span class="va">msum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="va">formula</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">dta_bladder</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">msum</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Pr(&gt;|z|) exp(coef) exp(-coef)  lower .95 upper .95   level   n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.287954e-02 0.6110123   1.636628 0.41442417 0.9008549  armcd2 340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 6.407916e-04 0.4460731   2.241785 0.28061816 0.7090818 covar12 340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 5.272933e-06 0.3075864   3.251119 0.18517346 0.5109230 covar13 340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2.125359e-08 0.1808795   5.528541 0.09943722 0.3290258 covar14 340</span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">dta_simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span class="r-in">  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span class="r-in">  status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span class="r-in">  armcd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span>,</span>
<span class="r-in">  var1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">45</span>, <span class="fl">55</span>, <span class="fl">65</span>, <span class="fl">75</span>, <span class="fl">55</span>, <span class="fl">65</span>, <span class="fl">85</span>, <span class="fl">75</span><span class="op">)</span>,</span>
<span class="r-in">  var2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F"</span>, <span class="st">"M"</span>, <span class="st">"F"</span>, <span class="st">"M"</span>, <span class="st">"F"</span>, <span class="st">"M"</span>, <span class="st">"F"</span>, <span class="st">"U"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">armcd</span> <span class="op">+</span> <span class="va">var1</span>, data <span class="op">=</span> <span class="va">dta_simple</span><span class="op">)</span></span>
<span class="r-in"><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">h_coxreg_univar_extract</span><span class="op">(</span></span>
<span class="r-in">  effect <span class="op">=</span> <span class="st">"armcd"</span>, covar <span class="op">=</span> <span class="st">"armcd"</span>, mod <span class="op">=</span> <span class="va">mod</span>, data <span class="op">=</span> <span class="va">dta_simple</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">result</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       effect  term       term_label level n       hr       lcl      ucl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 Treatment: armcd B vs control (A)     B 8 6.551448 0.4606904 93.16769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       pval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.165209</span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            effect   term        term_label level   n        hr       lcl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ref    Treatment:  armcd  2 vs control (1)     2 340 0.6386426 0.4557586</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1 Covariate: covar1 A Covariate Label     2 340  0.607037 0.4324571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              ucl       pval                   ci</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ref    0.8949131 0.02423805 0.4557586, 0.8949131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1 0.8520935 0.01257339 0.4324571, 0.8520935</span>
<span class="r-in"><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           effect   term        term_label level   n        hr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ref                   Treatment:  armcd  2 vs control (1)     2 340 0.6386426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.1              Covariate: covar1 A Covariate Label       340          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.armcd2/covar11 Covariate: covar1                 1     1     0.6284569</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.armcd2/covar12 Covariate: covar1                 2     2     0.5806499</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.armcd2/covar13 Covariate: covar1                 3     3     0.5486103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.armcd2/covar14 Covariate: covar1                 4     4     0.6910725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar2.1              Covariate: covar2         Sex (F/M)       340          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar2.armcd2/covar2F Covariate: covar2                 F     F     0.6678243</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar2.armcd2/covar2M Covariate: covar2                 M     M     0.5954021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             lcl       ucl       pval pval_inter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ref                   0.4557586 0.8949131 0.02423805           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.1                     NA        NA             0.9883021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.armcd2/covar11 0.3450471 1.1446499                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.armcd2/covar12 0.2684726 1.2558239                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.armcd2/covar13 0.2226814 1.3515868                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.armcd2/covar14 0.2308006 2.0692373                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar2.1                     NA        NA             0.7759013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar2.armcd2/covar2F 0.3649842 1.2219413                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar2.armcd2/covar2M 0.3572772 0.9922368                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                         ci</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ref                   0.4557586, 0.8949131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.1                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.armcd2/covar11 0.3450471, 1.1446499</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.armcd2/covar12 0.2684726, 1.2558239</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.armcd2/covar13 0.2226814, 1.3515868</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.armcd2/covar14 0.2308006, 2.0692373</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar2.1                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar2.armcd2/covar2F 0.3649842, 1.2219413</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar2.armcd2/covar2M 0.3572772, 0.9922368</span>
<span class="r-in"><span class="co"># fit_coxreg_multivar</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Cox regression: multivariate Cox regression.</span></span>
<span class="r-in"><span class="va">multivar_model</span> <span class="op">&lt;-</span> <span class="fu">fit_coxreg_multivar</span><span class="op">(</span></span>
<span class="r-in">  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">    time <span class="op">=</span> <span class="st">"time"</span>, event <span class="op">=</span> <span class="st">"status"</span>, arm <span class="op">=</span> <span class="st">"armcd"</span>,</span>
<span class="r-in">    covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covar1"</span>, <span class="st">"covar2"</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span>,</span>
<span class="r-in">  data <span class="op">=</span> <span class="va">dta_bladder</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Example without treatment arm.</span></span>
<span class="r-in"><span class="va">multivar_covs_model</span> <span class="op">&lt;-</span> <span class="fu">fit_coxreg_multivar</span><span class="op">(</span></span>
<span class="r-in">  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">    time <span class="op">=</span> <span class="st">"time"</span>, event <span class="op">=</span> <span class="st">"status"</span>,</span>
<span class="r-in">    covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covar1"</span>, <span class="st">"covar2"</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span>,</span>
<span class="r-in">  data <span class="op">=</span> <span class="va">dta_bladder</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">armcd</span> <span class="op">+</span> <span class="va">var1</span>, data <span class="op">=</span> <span class="va">dta_simple</span><span class="op">)</span></span>
<span class="r-in"><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">h_coxreg_multivar_extract</span><span class="op">(</span></span>
<span class="r-in">  var <span class="op">=</span> <span class="st">"var1"</span>, mod <span class="op">=</span> <span class="va">mod</span>, data <span class="op">=</span> <span class="va">dta_simple</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">result</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        pval        hr      lcl      ucl level n term term_label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.4456195 0.9423284 0.808931 1.097724  var1 8 var1       var1</span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/" class="external-link">broom</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">multivar_model</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       term         pval                        term_label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> armcd.1              armcd                            ARM (reference = 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> armcd.2                ARM   0.01232761                                 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.1            covar1 7.209956e-09 A Covariate Label (reference = 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.2 A Covariate Label  0.001120332                                 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.3 A Covariate Label 6.293725e-06                                 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.4 A Covariate Label 3.013875e-08                                 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar2.1            covar2                      Sex (F/M) (reference = F)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar2.2         Sex (F/M)    0.1910521                                 M</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 hr        lcl       ucl level                     ci</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> armcd.1                    NA        NA  &lt;NA&gt;                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> armcd.2  0.6062777 0.40970194 0.8971710     2   0.4097019, 0.8971710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.1                   NA        NA  &lt;NA&gt;                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.2 0.4564763 0.28481052 0.7316115     2   0.2848105, 0.7316115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.3 0.3069612 0.18386073 0.5124813     3   0.1838607, 0.5124813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar1.4 0.1817017 0.09939435 0.3321668     4 0.09939435, 0.33216684</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar2.1                   NA        NA  &lt;NA&gt;                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> covar2.2  1.289373 0.88087820 1.8873019     M   0.8808782, 1.8873019</span>
<span class="r-in"><span class="co"># s_coxreg</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">univar_model</span> <span class="op">&lt;-</span> <span class="fu">fit_coxreg_univar</span><span class="op">(</span></span>
<span class="r-in">  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">    time <span class="op">=</span> <span class="st">"time"</span>, event <span class="op">=</span> <span class="st">"status"</span>, arm <span class="op">=</span> <span class="st">"armcd"</span>,</span>
<span class="r-in">    covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covar1"</span>, <span class="st">"covar2"</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span>,</span>
<span class="r-in">  data <span class="op">=</span> <span class="va">dta_bladder</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">univar_model</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">s_coxreg</span><span class="op">(</span>df <span class="op">=</span> <span class="va">df1</span>, .var <span class="op">=</span> <span class="st">"hr"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`2 vs control (1)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6386426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`A Covariate Label`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.607037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`Sex (F/M)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6242738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Only covariates.</span></span>
<span class="r-in"><span class="va">univar_covs_model</span> <span class="op">&lt;-</span> <span class="fu">fit_coxreg_univar</span><span class="op">(</span></span>
<span class="r-in">  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">    time <span class="op">=</span> <span class="st">"time"</span>, event <span class="op">=</span> <span class="st">"status"</span>,</span>
<span class="r-in">    covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covar1"</span>, <span class="st">"covar2"</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span>,</span>
<span class="r-in">  data <span class="op">=</span> <span class="va">dta_bladder</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">df1_covs</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">univar_covs_model</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">s_coxreg</span><span class="op">(</span>df <span class="op">=</span> <span class="va">df1_covs</span>, .var <span class="op">=</span> <span class="st">"hr"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`2`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.446633</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`3`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3098658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`4`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1828626</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$M</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.3271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`A Covariate Label (reference = 1)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`Sex (F/M) (reference = F)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Multivariate.</span></span>
<span class="r-in"><span class="va">multivar_model</span> <span class="op">&lt;-</span> <span class="fu">fit_coxreg_multivar</span><span class="op">(</span></span>
<span class="r-in">  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">    time <span class="op">=</span> <span class="st">"time"</span>, event <span class="op">=</span> <span class="st">"status"</span>, arm <span class="op">=</span> <span class="st">"armcd"</span>,</span>
<span class="r-in">    covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covar1"</span>, <span class="st">"covar2"</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span>,</span>
<span class="r-in">  data <span class="op">=</span> <span class="va">dta_bladder</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">multivar_model</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">s_coxreg</span><span class="op">(</span>df <span class="op">=</span> <span class="va">df2</span>, .var <span class="op">=</span> <span class="st">"hr"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`2`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4564763</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`3`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3069612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`4`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1817017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`2`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6062777</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$M</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.289373</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`ARM (reference = 1)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`A Covariate Label (reference = 1)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`Sex (F/M) (reference = F)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Multivariate without treatment arm.</span></span>
<span class="r-in"><span class="va">multivar_covs_model</span> <span class="op">&lt;-</span> <span class="fu">fit_coxreg_multivar</span><span class="op">(</span></span>
<span class="r-in">  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">    time <span class="op">=</span> <span class="st">"time"</span>, event <span class="op">=</span> <span class="st">"status"</span>,</span>
<span class="r-in">    covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"covar1"</span>, <span class="st">"covar2"</span><span class="op">)</span></span>
<span class="r-in">  <span class="op">)</span>,</span>
<span class="r-in">  data <span class="op">=</span> <span class="va">dta_bladder</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"><span class="va">df2_covs</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">multivar_covs_model</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">s_coxreg</span><span class="op">(</span>df <span class="op">=</span> <span class="va">df2_covs</span>, .var <span class="op">=</span> <span class="st">"hr"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`2`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4600728</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`3`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3100455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`4`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1854177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$M</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.285406</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`A Covariate Label (reference = 1)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hr$`Sex (F/M) (reference = F)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="co"># summarize_coxreg</span></span>
<span class="r-in"><span class="va">result_univar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_rows_by.html" class="external-link">split_rows_by</a></span><span class="op">(</span><span class="st">"effect"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_rows_by.html" class="external-link">split_rows_by</a></span><span class="op">(</span><span class="st">"term"</span>, child_labels <span class="op">=</span> <span class="st">"hidden"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">summarize_coxreg</span><span class="op">(</span>conf_level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">result_univar</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        n    Hazard Ratio      95% CI      p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> —————————————————————————————————————————————————————————————————</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Treatment:                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2 vs control (1)    340       0.64       (0.43, 0.94)   0.0242 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Covariate:                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A Covariate Label   340       0.61       (0.41, 0.90)   0.0126 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sex (F/M)           340       0.62       (0.42, 0.92)   0.0182 </span>
<span class="r-in"></span>
<span class="r-in"><span class="va">result_multivar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_rows_by.html" class="external-link">split_rows_by</a></span><span class="op">(</span><span class="st">"term"</span>, child_labels <span class="op">=</span> <span class="st">"hidden"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">summarize_coxreg</span><span class="op">(</span>multivar <span class="op">=</span> <span class="cn">TRUE</span>, conf_level <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">result_multivar</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                     Hazard Ratio      95% CI      p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> —————————————————————————————————————————————————————————————————————————</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ARM (reference = 1)                                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                       0.61       (0.41, 0.90)   0.0123 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A Covariate Label (reference = 1)                                 &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                       0.46       (0.28, 0.73)   0.0011 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                       0.31       (0.18, 0.51)   &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                                       0.18       (0.10, 0.33)   &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sex (F/M) (reference = F)                                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M                                       1.29       (0.88, 1.89)   0.1911 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># When tabulating univariate models with only covariates, also `multivar = TRUE`</span></span>
<span class="r-in"><span class="co"># is used.</span></span>
<span class="r-in"><span class="va">result_univar_covs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_rows_by.html" class="external-link">split_rows_by</a></span><span class="op">(</span><span class="st">"term"</span>, child_labels <span class="op">=</span> <span class="st">"hidden"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">summarize_coxreg</span><span class="op">(</span>multivar <span class="op">=</span> <span class="cn">TRUE</span>, conf_level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">df1_covs</span><span class="op">)</span></span>
<span class="r-in"><span class="va">result_univar_covs</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                     Hazard Ratio      95% CI      p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> —————————————————————————————————————————————————————————————————————————</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A Covariate Label (reference = 1)                                 &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                       0.45       (0.28, 0.71)   0.0007 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                       0.31       (0.19, 0.52)   &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                                       0.18       (0.10, 0.33)   &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sex (F/M) (reference = F)                                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M                                       1.33       (0.91, 1.94)   0.1414 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># No change for the multivariate tabulation when no treatment arm is included.</span></span>
<span class="r-in"><span class="va">result_multivar_covs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://roche.github.io/rtables/reference/basic_table.html" class="external-link">basic_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://roche.github.io/rtables/reference/split_rows_by.html" class="external-link">split_rows_by</a></span><span class="op">(</span><span class="st">"term"</span>, child_labels <span class="op">=</span> <span class="st">"hidden"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu">summarize_coxreg</span><span class="op">(</span>multivar <span class="op">=</span> <span class="cn">TRUE</span>, conf_level <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://roche.github.io/rtables/reference/build_table.html" class="external-link">build_table</a></span><span class="op">(</span><span class="va">df2_covs</span><span class="op">)</span></span>
<span class="r-in"><span class="va">result_multivar_covs</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                     Hazard Ratio      95% CI      p-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> —————————————————————————————————————————————————————————————————————————</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A Covariate Label (reference = 1)                                 &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                       0.46       (0.29, 0.74)   0.0012 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                       0.31       (0.19, 0.52)   &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                                       0.19       (0.10, 0.34)   &lt;0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sex (F/M) (reference = F)                                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M                                       1.29       (0.88, 1.88)   0.1958 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="nest">
  <p>tern is a part of the <strong>NEST</strong> and <a href="https://pharmaverse.org/" class="external-link"><strong>pharmaverse</strong></a>.</p>
</div>
<script type="text/javascript" src="../analytics.js"></script></footer></div>

  

  

  </body></html>

